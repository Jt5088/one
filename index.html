<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CareerSignal — Know Yourself</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
<style>
:root {
  --bg: #0c0c0f;
  --surface: #131318;
  --surface2: #18181e;
  --surface3: #1e1e26;
  --border: rgba(255,255,255,0.06);
  --border2: rgba(255,255,255,0.1);
  --text-1: #ededf0;
  --text-2: #8b8b99;
  --text-3: #4a4a58;
  --pink: #8b5cf6;
  --pink-dim: rgba(139,92,246,0.1);
  --pink-glow: rgba(139,92,246,0.2);
  --violet: #6d4de0;
  --violet-dim: rgba(109,77,224,0.1);
  --cyan: #60a5fa;
  --cyan-dim: rgba(96,165,250,0.1);
  --lime: #6ee7b7;
  --lime-dim: rgba(110,231,183,0.1);
  --orange: #fb923c;
  --orange-dim: rgba(251,146,60,0.1);
  --r: 8px;
  --r2: 12px;
}
/* ── SHARED ICON SYSTEM ── */
.si {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
  color: inherit;
}
.si svg {
  width: 14px;
  height: 14px;
  display: block;
}
.si.sm svg { width: 12px; height: 12px; }
.si.lg svg { width: 16px; height: 16px; }
.clabel .si {
  opacity: 0.55;
  color: var(--text-3);
}
.clabel .si svg { width: 12px; height: 12px; }
.rank-hint .si svg { width: 12px; height: 12px; opacity: 0.5; }

* { box-sizing: border-box; margin: 0; padding: 0; }
html { scroll-behavior: smooth; }
body {
  font-family: 'Inter', sans-serif;
  background: var(--bg);
  color: var(--text-1);
  min-height: 100vh;
  font-size: 15px;
  line-height: 1.65;
  overflow-x: hidden;
  cursor: none;
}

/* CUSTOM CURSOR — refined dot only */
.cursor {
  position: fixed; top: 0; left: 0;
  width: 5px; height: 5px;
  background: var(--text-1);
  border-radius: 50%;
  pointer-events: none;
  z-index: 9999;
  transform: translate(-50%, -50%);
  transition: transform 0.08s, opacity 0.15s, width 0.15s, height 0.15s, background 0.15s;
}
.cursor-ring {
  position: fixed; top: 0; left: 0;
  width: 28px; height: 28px;
  border: 1px solid rgba(139,92,246,0.35);
  border-radius: 50%;
  pointer-events: none;
  z-index: 9998;
  transform: translate(-50%, -50%);
  transition: width 0.2s, height 0.2s, border-color 0.2s, opacity 0.2s;
}
body:has(button:hover) .cursor,
body:has([onclick]:hover) .cursor,
body:has(.ropt:hover) .cursor,
body:has(.copt:hover) .cursor { width: 8px; height: 8px; background: var(--pink); }
body:has(button:hover) .cursor-ring,
body:has([onclick]:hover) .cursor-ring,
body:has(.ropt:hover) .cursor-ring,
body:has(.copt:hover) .cursor-ring { width: 36px; height: 36px; border-color: rgba(139,92,246,0.5); }

/* MOUSE GLOW — subtle, cool */
#mouse-glow {
  position: fixed; pointer-events: none; z-index: 1;
  width: 480px; height: 480px;
  border-radius: 50%;
  background: radial-gradient(circle, rgba(109,77,224,0.08) 0%, transparent 65%);
  transform: translate(-50%, -50%);
  will-change: left, top;
}

/* ANIMATED BG */
#animated-bg { position: fixed; inset: 0; z-index: 0; overflow: hidden; }
.bg-blob {
  position: absolute; border-radius: 50%;
  filter: blur(90px);
  animation: blobMove ease-in-out infinite alternate;
  will-change: transform;
}
.b1 { width: 700px; height: 700px; background: radial-gradient(circle, #6d4de0, transparent 70%); opacity: 0.12; top: -280px; left: -180px; animation-duration: 26s; }
.b2 { width: 550px; height: 550px; background: radial-gradient(circle, #4f46e5, transparent 70%); opacity: 0.07; bottom: -80px; right: -100px; animation-duration: 32s; animation-delay: -8s; }
.b3 { width: 450px; height: 450px; background: radial-gradient(circle, #3b82f6, transparent 70%); opacity: 0.05; top: 45%; left: 40%; animation-duration: 40s; animation-delay: -14s; }
.b4 { display:none; }
@keyframes blobMove {
  0%   { transform: translate(0,0) scale(1); }
  50%  { transform: translate(40px,-30px) scale(1.04); }
  100% { transform: translate(-20px,40px) scale(0.97); }
}
body::before {
  content:''; position:fixed; inset:0; z-index:2; pointer-events:none;
  background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 512 512' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.75' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='0.03'/%3E%3C/svg%3E");
}
#grid-overlay {
  position: fixed; inset: 0; z-index: 1; pointer-events: none;
  background-image: linear-gradient(rgba(255,255,255,0.022) 1px, transparent 1px), linear-gradient(90deg, rgba(255,255,255,0.022) 1px, transparent 1px);
  background-size: 80px 80px;
  mask-image: radial-gradient(ellipse 75% 75% at 50% 50%, black 20%, transparent 100%);
}

/* HEADER */
header {
  position: fixed; top:0; left:0; right:0;
  z-index: 200; padding: 0 2rem; height: 62px;
  display: flex; align-items: center; justify-content: space-between;
  background: rgba(12,12,15,0.8);
  backdrop-filter: blur(28px); -webkit-backdrop-filter: blur(28px);
  border-bottom: 1px solid var(--border);
}
.logo {
  font-family: 'Inter', sans-serif; font-size: 0.95rem; font-weight: 700;
  color: var(--text-1); letter-spacing: -0.2px;
  display: flex; align-items: center; gap: 0.5rem;
}
.logo-mark {
  width: 26px; height: 26px; border-radius: 8px;
  background: linear-gradient(135deg, #6d4de0, #4f46e5);
  display: flex; align-items: center; justify-content: center;
  font-size: 0.62rem; font-weight: 900; color: white; letter-spacing: -0.5px;
}
.header-right { display: flex; align-items: center; gap: 1rem; }
.hprog { display: flex; align-items: center; gap: 0.7rem; font-size: 0.68rem; color: var(--text-3); font-family: 'JetBrains Mono', monospace; letter-spacing: 0.04em; }
.ptrack { width: 100px; height: 2px; background: var(--surface3); border-radius: 2px; overflow: hidden; }
.pfill { height: 100%; background: linear-gradient(90deg, var(--violet), var(--cyan)); border-radius: 2px; transition: width 0.3s ease; width: 0%; }
.hist-btn {
  display: flex;
  align-items: center;
  gap: 0.4rem;
  padding: 0.4rem 0.9rem;
  background: var(--surface2);
  border: 1px solid var(--border2);
  border-radius: 30px;
  color: var(--text-2);
  font-size: 0.75rem;
  font-family: 'Inter', sans-serif;
  font-weight: 500;
  cursor: none;
  transition: background 0.12s ease, color 0.12s ease, border-color 0.12s ease;
  white-space: nowrap;
}
.hist-btn:hover {
  background: var(--surface3);
  color: var(--text-1);
  border-color: rgba(124,58,237,0.35);
}
.hist-btn:active {
  transform: scale(0.96);
}
.hist-btn:focus-visible {
  outline: 2px solid rgba(139,92,246,0.6);
  outline-offset: 2px;
}
.hcount {
  display: inline-flex; align-items: center; justify-content: center;
  min-width: 17px; height: 17px; background: linear-gradient(135deg, #6d4de0, #4f46e5);
  color: var(--text-2); border-radius: 9px; font-size: 0.6rem; font-weight: 500;
  font-family: 'JetBrains Mono', monospace; padding: 0 0.3rem;
}

/* MAIN */
main { position: relative; z-index: 10; max-width: 780px; margin: 0 auto; padding: 82px 1.5rem 6rem; contain: layout style; }

/* SCREENS */
.screen { display: none; }
.screen.active { display: block; animation: screenIn 0.18s ease-out; }
@keyframes screenIn { from { opacity:0; transform:translateY(6px); } to { opacity:1; transform:translateY(0); } }

/* ── LANDING ── */
.landing-wrap { padding-top: 1rem; }
.landing-badge {
  display: inline-flex; align-items: center; gap: 0.55rem;
  padding: 0.35rem 0.85rem 0.35rem 0.45rem;
  background: var(--surface2); border: 1px solid var(--border2); border-radius: 30px;
  margin-bottom: 2.25rem; font-size: 0.7rem; font-family: 'JetBrains Mono', monospace;
  color: var(--text-2); letter-spacing: 0.04em;
  animation: none;
}
.badge-icon {
  width: 20px; height: 20px;
  border-radius: 50%;
  background: linear-gradient(135deg, #6d4de0, #4f46e5);
  display: flex; align-items: center; justify-content: center;
  color: rgba(255,255,255,0.8);
  flex-shrink: 0;
}
.badge-icon svg { width: 10px; height: 10px; }
.badge-live { width: 5px; height: 5px; border-radius: 50%; background: var(--lime); opacity: 0.8; }
@keyframes ping { 0%,100% { opacity:0.8; } 50% { opacity:0.4; } }

.hero-label { font-family: 'Inter', sans-serif; font-size: clamp(2.6rem, 6.5vw, 4.8rem); font-weight: 800; line-height: 1.02; letter-spacing: -2px; color: var(--text-1); margin-bottom: 0.15rem; animation: none; }
.hero-grad {
  background: linear-gradient(135deg, #818cf8 0%, #8b5cf6 45%, #60a5fa 100%);
  -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;
  background-size: 200%;
  animation: gradShift 8s linear infinite;
}
.hero-sub { font-family: 'Inter', sans-serif; font-size: clamp(2rem, 5.5vw, 4rem); font-weight: 700; letter-spacing: -1.5px; color: rgba(237,237,240,0.15); margin-bottom: 2rem; animation: none; }
@keyframes gradShift { 0%,100% { background-position: 0%; } 50% { background-position: 100%; } }

.hero-desc { font-size: 1rem; color: var(--text-2); max-width: 500px; line-height: 1.78; margin-bottom: 2.5rem; animation: none; }
.hero-desc em { color: var(--text-1); font-style: normal; font-weight: 600; }

/* FEATURE GRID */
.feature-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 0.7rem;
  margin: 1.8rem 0;
}
@media (max-width: 520px) { .feature-grid { grid-template-columns: 1fr; } }
@media(max-width:560px){.feature-grid{grid-template-columns:1fr;}}
.fcard {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: var(--r2);
  padding: 1.35rem;
  position: relative;
  overflow: hidden;
  transition: border-color 0.3s, transform 0.3s, box-shadow 0.3s;
}
.fcard:hover {
  border-color: rgba(139,92,246,0.2);
  transform: translateY(-2px);
  box-shadow: 0 8px 28px rgba(0,0,0,0.28), 0 0 0 1px rgba(139,92,246,0.07);
}
.fcard::after { content:''; position:absolute; inset:0; background:linear-gradient(135deg, rgba(124,58,237,0.06), transparent); opacity:0; transition:opacity 0.25s; }
.fcard:hover { border-color: rgba(139,92,246,0.3); }
.fcard:hover::after { opacity:1; }
.fc-icon {
  width: 40px; height: 40px;
  border-radius: 10px;
  display: flex; align-items: center; justify-content: center;
  margin-bottom: 0.85rem;
  flex-shrink: 0;
}
.fc-icon svg { width: 18px; height: 18px; }
.fc-title { font-size:0.88rem; font-weight:700; color:var(--text-1); margin-bottom:0.28rem; }
.fc-desc { font-size:0.76rem; color:var(--text-3); line-height:1.6; }

/* HOW IT WORKS */
.how-wrap { margin-bottom: 2.5rem; animation: none; }
.how-eyebrow { font-family:'JetBrains Mono',monospace; font-size:0.64rem; text-transform:uppercase; letter-spacing:0.15em; color:var(--text-3); margin-bottom:0.9rem; display:flex; align-items:center; gap:0.55rem; }
.how-eyebrow::before { content:''; width:20px; height:1px; background:var(--border2); display:block; }
.steps {
  display: flex;
  flex-direction: column;
  gap: 0;
  position: relative;
  padding-left: 0;
}
.steps::before {
  content: '';
  position: absolute;
  left: 18px;
  top: 28px;
  bottom: 28px;
  width: 1px;
  background: linear-gradient(to bottom, rgba(139,92,246,0.4), rgba(139,92,246,0.05));
}
.step {
  display: flex;
  align-items: flex-start;
  gap: 1rem;
  padding: 0.9rem 0;
  position: relative;
}
.step:not(:last-child)::after { content:''; position:absolute; top:1.5rem; right:0; width:1px; height:26px; background:var(--border2); }
.step-n {
  font-family: 'JetBrains Mono', monospace;
  font-size: 0.68rem;
  font-weight: 600;
  color: var(--pink);
  width: 36px;
  height: 36px;
  min-width: 36px;
  background: rgba(139,92,246,0.1);
  border: 1px solid rgba(139,92,246,0.22);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  letter-spacing: 0;
  position: relative;
  z-index: 1;
}
.step-t { font-size:0.82rem; font-weight:700; color:var(--text-1); margin-bottom:0.12rem; }
.step-d { font-size:0.72rem; color:var(--text-3); line-height:1.5; }
.step:not(:first-child) { padding-left:1rem; }

/* SOCIAL PROOF */
.proof { display:flex; align-items:center; gap:1.2rem; flex-wrap:wrap; margin-bottom:2.5rem; animation: none; }
.avs { display:flex; }
.av { width:29px; height:29px; border-radius:50%; border:2px solid var(--bg); display:flex; align-items:center; justify-content:center; font-size:0.58rem; font-weight:700; color:white; margin-left:-7px; }
.av:first-child { margin-left:0; }
.av1 { background:linear-gradient(135deg,var(--violet),var(--pink)); }
.av2 { background:linear-gradient(135deg,var(--cyan),var(--violet)); }
.av3 { background:linear-gradient(135deg,var(--lime),var(--cyan)); filter:saturate(0.8); }
.av4 { background:linear-gradient(135deg,var(--orange),var(--pink)); }
.proof-text { font-size:0.77rem; color:var(--text-3); line-height:1.5; }
.proof-text strong { color:var(--text-2); font-weight:600; }

/* CTA */
.cta-row { display:flex; align-items:center; gap:1.25rem; flex-wrap:wrap; animation: none; }
.meta-list { display:flex; gap:0.45rem; flex-wrap:wrap; }
.mpill { display:flex; align-items:center; gap:0.28rem; padding:0.26rem 0.6rem; background:var(--surface2); border:1px solid var(--border); border-radius:30px; font-size:0.7rem; color:var(--text-3); }
.mpdot { width:3px; height:3px; border-radius:50%; background:var(--lime); opacity:0.7; flex-shrink:0; }

@keyframes fadeUp { from { opacity:0; transform:translateY(10px); } to { opacity:1; transform:translateY(0); } }

/* ── SECTIONS ── */
.s-eye { font-family:'JetBrains Mono',monospace; font-size:0.64rem; text-transform:uppercase; letter-spacing:0.14em; color:var(--text-3); margin-bottom:0.5rem; }
.s-title { font-family:'Inter',sans-serif; font-size:1.6rem; font-weight:700; color:var(--text-1); letter-spacing:-0.5px; margin-bottom:0.3rem; line-height:1.25; }
.s-sub { color:var(--text-2); font-size:0.88rem; margin-bottom:2rem; line-height:1.65; }

/* Q BLOCK */
.qb { background:var(--surface); border:1px solid var(--border); border-radius:var(--r2); padding:1.5rem 1.6rem; margin-bottom:0.9rem; transition:border-color 0.2s, box-shadow 0.2s; }
.qb:focus-within { border-color:rgba(139,92,246,0.35); box-shadow:0 0 0 2px rgba(139,92,246,0.06); }
.qn { font-family:'JetBrains Mono',monospace; font-size:0.62rem; text-transform:uppercase; letter-spacing:0.1em; color:var(--text-3); margin-bottom:0.4rem; }
.qt { font-size:0.95rem; font-weight:600; color:var(--text-1); margin-bottom:0.22rem; line-height:1.5; }
.qh { font-size:0.78rem; color:var(--text-3); margin-bottom:0.9rem; font-style:italic; line-height:1.55; }

textarea, input[type="text"], input[type="number"], select {
  width:100%; background:var(--surface2); border:1px solid var(--border); border-radius:var(--r);
  padding:0.82rem 1rem; font-family:'Inter',sans-serif; font-size:0.9rem; color:var(--text-1);
  transition:border-color 0.2s, background 0.2s; resize:vertical; line-height:1.6;
}
textarea:focus, input:focus, select:focus { outline:none; border-color:rgba(139,92,246,0.45); background:var(--surface3); transition:border-color 0.1s; }
textarea { min-height:86px; }
textarea::placeholder, input::placeholder { color:var(--text-3); }
select option { background:var(--surface2); }

.rg, .cg { display:flex; flex-direction:column; gap:0.45rem; }
.ropt, .copt {
  display: flex;
  align-items: flex-start;
  gap: 0.75rem;
  padding: 0.72rem 1rem;
  background: var(--surface2);
  border: 1px solid var(--border);
  border-radius: var(--r);
  cursor: none;
  transition: background 0.13s ease, border-color 0.13s ease,
              box-shadow 0.13s ease, transform 0.1s ease;
  user-select: none;
  pointer-events: auto;
  position: relative;
  z-index: 5;
}
.ropt:hover, .copt:hover {
  border-color: rgba(139,92,246,0.3);
  background: var(--surface3);
}
.ropt:active, .copt:active {
  transform: scale(0.988);
  background: var(--surface3);
}
.ropt.sel, .copt.sel {
  border-color: rgba(139,92,246,0.5);
  background: rgba(109,77,224,0.09);
  box-shadow: inset 0 0 0 1px rgba(139,92,246,0.15),
              0 0 0 0px rgba(139,92,246,0);
}
.ropt input, .copt input { display:none; }
.oring { width:16px; height:16px; border:1.5px solid var(--border2); border-radius:50%; flex-shrink:0; margin-top:2px; transition:all 0.14s; display:flex; align-items:center; justify-content:center; }
.copt .oring { border-radius:5px; }
.ropt.sel .oring, .copt.sel .oring {
  border-color: var(--pink);
  background: linear-gradient(135deg, var(--pink), var(--violet));
  box-shadow: 0 0 0 3px rgba(139,92,246,0.15);
}
.ropt.sel .oring::after { content:''; width:5px; height:5px; background:white; border-radius:50%; display:block; }
.copt.sel .oring::after {
  content: '';
  display: block;
  width: 10px; height: 10px;
  background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 10 10' fill='none' stroke='white' stroke-width='1.8' stroke-linecap='round' stroke-linejoin='round' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M2 5l2.5 2.5L8 3'/%3E%3C/svg%3E");
  background-size: contain;
  background-repeat: no-repeat;
}
.olabel { font-size:0.86rem; color:var(--text-1); line-height:1.5; }
.olabel strong { display:block; font-weight:600; font-size:0.88rem; }
.olabel small { color:var(--text-3); font-size:0.76rem; }

.scwrap { display:flex; gap:0.38rem; flex-wrap:wrap; }
.scbtn {
  flex: 1;
  min-width: 40px;
  padding: 0.62rem 0.4rem;
  background: var(--surface2);
  border: 1px solid var(--border);
  border-radius: var(--r);
  font-family: 'JetBrains Mono', monospace;
  font-size: 0.85rem;
  font-weight: 500;
  color: var(--text-2);
  cursor: none;
  transition: background 0.12s ease, border-color 0.12s ease,
              color 0.12s ease, transform 0.1s ease;
  text-align: center;
  user-select: none;
}
.scbtn:hover {
  border-color: rgba(124,58,237,0.4);
  background: var(--surface3);
  color: var(--text-1);
}
.scbtn:active {
  transform: scale(0.93);
}

.scbtn:focus-visible {
  outline: 2px solid rgba(139,92,246,0.6);
  outline-offset: 2px;
}
.scbtn.sel {
  background: rgba(109,77,224,0.18);
  border-color: rgba(139,92,246,0.55);
  color: var(--text-1);
  box-shadow: inset 0 0 0 1px rgba(139,92,246,0.2);
}


.sclabs { display:flex; justify-content:space-between; margin-top:0.32rem; font-size:0.68rem; color:var(--text-3); }

.rkrow { display:flex; align-items:center; gap:0.7rem; padding:0.65rem 0.95rem; background:var(--surface2); border:1px solid var(--border); border-radius:var(--r); margin-bottom:0.38rem; }
.rknum { font-family:'JetBrains Mono',monospace; font-size:0.7rem; color:var(--text-3); min-width:17px; }
.rkrow select { flex:1; background:transparent; border:none; font-size:0.88rem; color:var(--text-1); cursor:none; padding:0; }
.rkrow select:focus { border:none; background:transparent; }

/* DRAG RANK */
.rank-hint { font-size:0.72rem; color:var(--text-3); font-style:italic; margin-bottom:0.55rem; display:flex; align-items:center; gap:0.4rem; }
/* rank-hint::before removed — SVG injected inline */
.rank-list { display:flex; flex-direction:column; gap:0.38rem; }
.rank-item {
  display:flex; align-items:center; gap:0.75rem;
  padding:0.68rem 1rem;
  background:var(--surface2); border:1px solid var(--border); border-radius:var(--r);
  cursor:grab; user-select:none; transition:background 0.14s, border-color 0.14s, box-shadow 0.14s;
}
.rank-item:hover { border-color:rgba(124,58,237,0.4); background:var(--surface3); }
.rank-item.dragging { opacity:0.45; cursor:grabbing; }
.rank-item.drag-over { border-color:rgba(139,92,246,0.5); background:var(--pink-dim); box-shadow:0 0 0 1px rgba(139,92,246,0.15); }
.rank-grip {
  width: 16px; height: 16px;
  color: var(--text-3);
  flex-shrink: 0;
  cursor: grab;
  display: flex; align-items: center;
  opacity: 0.5;
  transition: opacity 0.12s;
}
.rank-grip:hover, .rank-item:hover .rank-grip { opacity: 0.85; }
.rank-grip svg { width: 100%; height: 100%; }
.rank-pos {
  font-family:'JetBrains Mono',monospace; font-size:0.65rem; font-weight:700;
  color:var(--bg); background:linear-gradient(135deg,var(--pink),var(--violet));
  width:20px; height:20px; border-radius:50%;
  display:flex; align-items:center; justify-content:center; flex-shrink:0;
}
.rank-label { font-size:0.86rem; color:var(--text-1); flex:1; }

.btn {
  display: inline-flex;
  align-items: center;
  gap: 0.5rem;
  padding: 0.8rem 1.7rem;
  border-radius: 30px;
  font-family: 'Inter', sans-serif;
  font-size: 0.88rem;
  font-weight: 700;
  cursor: none;
  border: 1.5px solid transparent;
  transition: background 0.15s ease, border-color 0.15s ease,
              box-shadow 0.15s ease, transform 0.12s ease, color 0.15s ease,
              opacity 0.15s ease;
  letter-spacing: 0.02em;
  white-space: nowrap;
  position: relative;
  user-select: none;
  -webkit-user-select: none;
}
.btn:focus-visible {
  outline: 2px solid rgba(139,92,246,0.7);
  outline-offset: 3px;
}
.btn:active { transform: translateY(1px) scale(0.985); }
.btn:disabled, .btn[aria-disabled="true"] {
  opacity: 0.38;
  cursor: not-allowed;
  pointer-events: none;
}
.btn.loading {
  pointer-events: none;
  cursor: not-allowed;
}
.btn-p {
  background: var(--text-1);
  color: var(--bg);
  border-color: var(--text-1);
}
.btn-p:hover {
  background: #fff;
  transform: translateY(-1px);
  box-shadow: 0 3px 14px rgba(237,237,240,0.13);
}
.btn-p:active {
  transform: translateY(0px);
  box-shadow: none;
}
.btn-a {
  background: linear-gradient(135deg, #6d4de0, #4f46e5);
  color: white;
  border: none;
  box-shadow: 0 2px 16px rgba(109,77,224,0.25);
  position: relative;
  overflow: hidden;
}
.btn-a::after {
  content: '';
  position: absolute;
  inset: 0;
  background: linear-gradient(135deg, transparent, rgba(255,255,255,0.12), transparent);
  transform: translateX(-100%);
  transition: transform 0.45s ease;
}
.btn-a:hover {
  transform: translateY(-1px);
  box-shadow: 0 5px 22px rgba(109,77,224,0.35);
}
.btn-a:hover::after { transform: translateX(100%); }

.btn-a:active {
  transform: translateY(0px) scale(0.987);
  box-shadow: 0 1px 8px rgba(109,77,224,0.2);
}

.btn-g {
  background: transparent;
  color: var(--text-2);
  border-color: var(--border2);
}
.btn-g:hover {
  background: var(--surface2);
  color: var(--text-1);
  border-color: rgba(139,92,246,0.25);
}
.btn-g:active {
  background: var(--surface3);
  transform: translateY(0px) scale(0.985);
}
.btn-lg {
  padding: 1rem 2.2rem;
  font-size: 1rem;
}

/* ── BUTTON LOADING STATE ── */
.btn-spinner {
  display: none;
  width: 14px;
  height: 14px;
  border: 2px solid rgba(255,255,255,0.25);
  border-top-color: rgba(255,255,255,0.9);
  border-radius: 50%;
  animation: btn-spin 0.65s linear infinite;
  flex-shrink: 0;
}
.btn.loading .btn-spinner { display: block; }
.btn.loading .btn-label   { opacity: 0.7; }
@keyframes btn-spin {
  to { transform: rotate(360deg); }
}

/* ── RESUME CLEAR BUTTON ── */
.resume-clear {
  background: transparent;
  border: 1px solid var(--border2);
  border-radius: 6px;
  color: var(--text-3);
  font-size: 0.72rem;
  font-family: 'Inter', sans-serif;
  padding: 0.22rem 0.6rem;
  cursor: none;
  transition: color 0.12s ease, border-color 0.12s ease, background 0.12s ease;
}
.resume-clear:hover {
  color: var(--text-1);
  border-color: rgba(139,92,246,0.35);
  background: var(--surface2);
}
.resume-clear:active { transform: scale(0.94); }

.navrow { display:flex; justify-content:space-between; align-items:center; margin-top:2.1rem; gap:1rem; }

/* LOADING */
.lwrap { text-align:center; padding:5rem 2rem; }
.sring { width:40px; height:40px; border:1.5px solid var(--surface3); border-top-color:var(--pink); border-radius:50%; animation:spin 0.75s linear infinite; margin:0 auto 1.8rem; }
@keyframes spin { to { transform:rotate(360deg); } }
.ltitle { font-family:'Inter',sans-serif; font-size:1.5rem; font-weight:700; color:var(--text-1); margin-bottom:0.35rem; letter-spacing:-0.5px; }
.lsub { color:var(--text-3); font-size:0.82rem; margin-bottom:1.8rem; }
.lsteps { display:flex; flex-direction:column; gap:0.4rem; max-width:290px; margin:0 auto; }
.lstep { display:flex; align-items:center; gap:0.7rem; font-size:0.8rem; color:var(--text-3); opacity:0; transition:opacity 0.4s; }
.lstep.vis { opacity:1; color:var(--text-2); }
.lstep.done { color:var(--lime); }
.sbul { width:20px; height:20px; border-radius:50%; border:1px solid var(--border2); flex-shrink:0; display:flex; align-items:center; justify-content:center; font-family:'JetBrains Mono',monospace; font-size:0.58rem; color:var(--text-3); transition:all 0.3s; }
.lstep.done .sbul { background:linear-gradient(135deg,var(--lime),var(--cyan)); border-color:transparent; color:#06060a; font-size:0.68rem; }

/* RESULT */
.rhero { background:var(--surface); border:1px solid var(--border); border-radius:var(--r2); padding:2.25rem 2rem; margin-bottom:1.25rem; position:relative; overflow:hidden; }
.rhero::before { content:''; position:absolute; top:0; left:0; right:0; height:1px; background:linear-gradient(90deg,transparent,var(--pink),var(--violet),transparent); }
.rkicker { font-family:'JetBrains Mono',monospace; font-size:0.66rem; text-transform:uppercase; letter-spacing:0.14em; color:var(--text-3); margin-bottom:0.65rem; }
.rtitle { font-family:'Inter',sans-serif; font-size:1.9rem; font-weight:700; color:var(--text-1); margin-bottom:0.4rem; letter-spacing:-0.5px; }
.rsub { color:var(--text-2); font-size:0.86rem; }
.mrow { display:flex; align-items:center; gap:0.7rem; margin-top:1.15rem; flex-wrap:wrap; }
.cbadge { display:inline-flex; align-items:center; gap:0.38rem; padding:0.28rem 0.75rem; border-radius:30px; font-size:0.72rem; font-weight:700; letter-spacing:0.05em; text-transform:uppercase; }
.ch  { background:rgba(110,231,183,0.1); color:var(--lime); border:1px solid rgba(110,231,183,0.25); }
.cm  { background:var(--pink-dim); color:var(--pink); border:1px solid rgba(139,92,246,0.25); }
.cl  { background:var(--orange-dim); color:var(--orange); border:1px solid rgba(255,107,53,0.28); }
.sbadge { font-size:0.77rem; color:var(--text-3); font-family:'JetBrains Mono',monospace; }

.pcard { background:var(--surface); border:1px solid var(--border); border-radius:var(--r2); padding:1.5rem 1.6rem; margin-bottom:0.8rem; }
.chead { display:flex; align-items:center; justify-content:space-between; margin-bottom:1rem; }
.clabel { font-family:'JetBrains Mono',monospace; font-size:0.64rem; text-transform:uppercase; letter-spacing:0.12em; color:var(--text-3); display:flex; align-items:center; gap:0.45rem; }
.clabel::after { content:''; display:block; width:36px; height:1px; background:var(--border2); }

.sigleg { display:flex; align-items:center; gap:0.5rem; font-size:0.7rem; color:var(--text-3); font-style:italic; margin-bottom:0.9rem; padding:0.55rem 0.75rem; background:var(--surface2); border-radius:var(--r); border:1px solid var(--border); }
.ldots { display:flex; gap:2px; }
.ld { width:5px; height:5px; border-radius:50%; }
.ld.on { background:var(--pink); }
.ld.off { background:var(--surface3); }

.sitem { display:flex; align-items:flex-start; gap:0.9rem; padding:0.85rem; background:var(--surface2); border-radius:var(--r); margin-bottom:0.45rem; transition:background 0.2s; }
.sitem:hover { background:var(--surface3); }
.sdots { display:flex; gap:3px; flex-shrink:0; padding-top:3px; }
.sd { width:6px; height:6px; border-radius:50%; background:var(--surface3); }
.sd.on { background:linear-gradient(135deg,var(--pink),var(--violet)); }
.sbody { flex:1; min-width:0; }
.sname { font-weight:700; font-size:0.9rem; color:var(--text-1); margin-bottom:0.12rem; }
.sev { font-size:0.77rem; color:var(--text-3); line-height:1.5; }
.slabel { font-size:0.65rem; font-family:'JetBrains Mono',monospace; color:var(--text-3); flex-shrink:0; white-space:nowrap; }

.tags { display:flex; flex-wrap:wrap; gap:0.38rem; }
.tag { padding:0.26rem 0.68rem; border-radius:30px; font-size:0.76rem; font-weight:600; line-height:1.4; }
.ta { background:var(--pink-dim); color:var(--pink); border:1px solid rgba(139,92,246,0.2); }
.ts { background:var(--lime-dim); color:var(--lime); border:1px solid rgba(110,231,183,0.2); }
.tr { background:var(--orange-dim); color:var(--orange); border:1px solid rgba(255,107,53,0.2); }
.tsk{ background:var(--cyan-dim); color:var(--cyan); border:1px solid rgba(96,165,250,0.2); }
.tl { background:var(--violet-dim); color:#a78bfa; border:1px solid rgba(124,58,237,0.2); }
.td { background:var(--surface2); color:var(--text-2); border:1px solid var(--border2); }

.bgrid { display:grid; grid-template-columns:1fr 1fr; gap:0.7rem; }
@media(max-width:560px){.bgrid{grid-template-columns:1fr;}}
.bitem { background:var(--surface2); border-radius:var(--r); padding:0.7rem 0.85rem; }
.bk { font-size:0.68rem; text-transform:uppercase; letter-spacing:0.06em; color:var(--text-3); font-weight:600; margin-bottom:0.22rem; }
.bv { font-size:0.9rem; font-weight:700; color:var(--text-1); }
.bbar { height:2px; border-radius:2px; margin-top:0.38rem; background:var(--surface3); position:relative; }
.bbar::after { content:''; position:absolute; top:0; left:0; height:100%; border-radius:2px; }
.bbar[data-v="low"]::after    { width:22%; background:var(--cyan); }
.bbar[data-v="medium"]::after { width:54%; background:linear-gradient(90deg,var(--violet),var(--pink)); }
.bbar[data-v="high"]::after   { width:90%; background:linear-gradient(90deg,var(--pink),var(--orange)); }

.mitem, .aitem { padding:0.8rem 0.85rem; background:var(--surface2); border-radius:var(--r); margin-bottom:0.45rem; }
.mitem { border-left:2px solid rgba(110,231,183,0.5); }
.aitem { border-left:2px solid rgba(251,146,60,0.5); }
.mdrv { font-weight:700; font-size:0.88rem; color:var(--text-1); margin-bottom:0.12rem; }
.asig { font-weight:700; font-size:0.88rem; color:var(--orange); margin-bottom:0.12rem; }
.mev,.aev { font-size:0.76rem; color:var(--text-3); line-height:1.5; }

.crow { display:flex; justify-content:space-between; align-items:center; padding:0.65rem 0; border-bottom:1px solid var(--border); font-size:0.86rem; }
.crow:last-child { border-bottom:none; }
.ck { color:var(--text-3); }
.cv { font-weight:600; color:var(--text-1); }

.alist { list-style:none; display:flex; flex-direction:column; gap:0.38rem; }
.alist li { display:flex; gap:0.55rem; font-size:0.81rem; color:var(--text-2); line-height:1.55; }
.alist li::before {
  content: '';
  display: block;
  width: 14px;
  height: 14px;
  flex-shrink: 0;
  margin-top: 0.12em;
  background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 16 16' fill='none' stroke='%234a4a58' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M5 3l5 5-5 5'/%3E%3C/svg%3E");
  background-size: contain;
  background-repeat: no-repeat;
}

.twocol { display:grid; grid-template-columns:1fr 1fr; gap:1rem; }
@media(max-width:560px){.twocol{grid-template-columns:1fr;}}
.colh { font-size:0.68rem; text-transform:uppercase; letter-spacing:0.06em; font-weight:700; margin-bottom:0.45rem; }

.fit-stitle { font-family:'JetBrains Mono',monospace; font-size:0.64rem; text-transform:uppercase; letter-spacing:0.12em; color:var(--text-3); margin-bottom:0.7rem; display:flex; align-items:center; gap:0.45rem; }
.fit-stitle::after { content:''; flex:1; height:1px; background:var(--border); }

.fitcard { background:var(--surface2); border:1px solid var(--border); border-radius:var(--r2); margin-bottom:0.55rem; overflow:hidden; transition:border-color 0.2s; }
.fitcard:hover { border-color:var(--border2); }
.fctrig { display:flex; align-items:center; gap:0.85rem; padding:1rem 1.3rem; cursor:none; user-select:none; width:100%; background:none; border:none; text-align:left; transition:background 0.14s; }
.fctrig:hover { background:rgba(255,255,255,0.02); }
.ficon {
  width: 36px; height: 36px;
  border-radius: 9px;
  background: var(--surface3);
  border: 1px solid var(--border2);
  display: flex; align-items: center; justify-content: center;
  flex-shrink: 0;
  color: var(--text-2);
  font-size: 0; /* suppress any stray text */
}
.ficon .si svg { width: 16px; height: 16px; }
.ftwrap { flex:1; min-width:0; }
.ftitle { font-weight:700; font-size:0.93rem; color:var(--text-1); margin-bottom:0.08rem; }
.fsub { font-size:0.75rem; color:var(--text-3); }
.fmatch { display:flex; align-items:center; gap:0.38rem; flex-shrink:0; }
.fpct { font-family:'JetBrains Mono',monospace; font-size:0.8rem; font-weight:700; }
.fbarw { width:55px; height:2px; background:var(--surface3); border-radius:2px; overflow:hidden; }
.fbar { height:100%; border-radius:2px; }
.fchev { opacity:0.35; transition:transform 0.3s, opacity 0.2s; display:flex; align-items:center; flex-shrink:0; }
.fitcard.open .fchev { transform:rotate(180deg); opacity:0.75; }
.fcbody { max-height:0; overflow:hidden; transition:max-height 0.28s ease; }
.fitcard.open .fcbody { max-height:2400px; }
.fcinner { padding:0 1.3rem 1.3rem; border-top:1px solid var(--border); }
.fdesc { font-size:0.85rem; color:var(--text-2); line-height:1.7; margin:0.9rem 0; }

.subcol { background:var(--surface); border:1px solid var(--border); border-radius:var(--r); margin-bottom:0.42rem; overflow:hidden; }
.subtrig { display:flex; align-items:center; gap:0.55rem; padding:0.7rem 0.95rem; cursor:none; user-select:none; width:100%; background:none; border:none; text-align:left; transition:background 0.14s; }
.subtrig:hover { background:var(--surface2); }
.stico {
  width: 20px; height: 20px;
  display: flex; align-items: center; justify-content: center;
  flex-shrink: 0;
  color: var(--text-3);
}
.stico .si svg { width: 13px; height: 13px; }
.stlab { flex:1; font-size:0.8rem; font-weight:600; color:var(--text-2); }
.stchev { opacity:0.3; font-size:0.6rem; transition:transform 0.28s; }
.subcol.open .stchev { transform:rotate(180deg); }
.subbody { max-height:0; overflow:hidden; transition:max-height 0.2s ease; }
.subcol.open .subbody { max-height:1500px; }
.subinner { padding:0 0.95rem 0.95rem; border-top:1px solid var(--border); }
.subtext { font-size:0.81rem; color:var(--text-2); line-height:1.7; margin-top:0.7rem; }
.subtext ul { padding-left:1.1rem; margin-top:0.45rem; }
.subtext ul li { margin-bottom:0.28rem; }

.niche-item { padding:0.62rem 0.75rem; background:var(--surface2); border-radius:8px; margin-bottom:0.38rem; }
.niche-head { display:flex; align-items:center; justify-content:space-between; margin-bottom:0.18rem; }
.niche-name { font-size:0.81rem; font-weight:700; color:var(--text-1); }
.niche-dem { font-size:0.62rem; font-family:'JetBrains Mono',monospace; text-transform:uppercase; letter-spacing:0.06em; }
.niche-what { font-size:0.76rem; color:var(--text-3); line-height:1.5; }

.specgrid { display:flex; flex-wrap:wrap; gap:0.38rem; margin-top:0.55rem; }
.spchip { padding:0.26rem 0.68rem; background:var(--surface2); border:1px solid var(--border2); border-radius:30px; font-size:0.74rem; color:var(--text-2); cursor:none; transition:all 0.14s; }
.spchip:hover { background:var(--violet-dim); border-color:rgba(139,92,246,0.3); color:#a78bfa; }

.eaitem { display:flex; align-items:flex-start; gap:0.45rem; padding:0.45rem 0; border-bottom:1px solid var(--border); }
.eaitem:last-child { border-bottom:none; }
.eatf { font-family:'JetBrains Mono',monospace; font-size:0.66rem; color:var(--text-3); flex-shrink:0; padding-top:0.05rem; white-space:nowrap; }
.eaact { font-size:0.79rem; color:var(--text-2); line-height:1.55; }

.tlrow { display:flex; flex-wrap:wrap; gap:0.5rem; margin-top:0.7rem; }
.tlph { text-align:center; min-width:70px; }
.tldot { width:26px; height:26px; border-radius:50%; background:linear-gradient(135deg,var(--violet),var(--pink)); display:flex; align-items:center; justify-content:center; font-family:'JetBrains Mono',monospace; font-size:0.58rem; color:white; font-weight:700; margin:0 auto 0.28rem; }
.tllab { font-size:0.66rem; color:var(--text-3); }
.tltime { font-size:0.64rem; color:var(--text-3); font-family:'JetBrains Mono',monospace; }

.tgroup { border:1px solid var(--border); border-radius:var(--r); overflow:hidden; margin-bottom:0.65rem; }
.tghead { padding:0.55rem 0.95rem; background:var(--surface2); font-size:0.75rem; font-weight:700; color:var(--text-2); border-bottom:1px solid var(--border); }
.tgopts { display:flex; gap:0.45rem; padding:0.65rem; }

.jblock { background:#04040a; border:1px solid var(--border); border-radius:var(--r2); padding:1.4rem; overflow-x:auto; position:relative; }
.jblock pre { font-family:'JetBrains Mono',monospace; font-size:0.74rem; color:#7a748e; line-height:1.72; white-space:pre-wrap; word-break:break-word; }
.jk { color:#a78bfa; } .js { color:#6ee7b7; } .jn { color:#93c5fd; } .jb { color:#c4b5fd; }
.copybtn {
  position: absolute;
  top: 0.9rem;
  right: 0.9rem;
  padding: 0.32rem 0.7rem;
  background: var(--surface2);
  border: 1px solid var(--border2);
  border-radius: 5px;
  color: var(--text-2);
  font-size: 0.7rem;
  font-family: 'Inter', sans-serif;
  font-weight: 500;
  cursor: none;
  transition: background 0.12s ease, color 0.12s ease;
}
.copybtn:hover {
  background: var(--surface3);
  color: var(--text-1);
}
.copybtn:active {
  transform: scale(0.94);
}

.errbox { background:var(--orange-dim); border:1px solid rgba(255,107,53,0.28); border-radius:var(--r); padding:0.95rem 1.1rem; color:var(--orange); font-size:0.86rem; }
.div { border:none; border-top:1px solid var(--border); margin:1.4rem 0; }
.ract { display:flex; gap:0.7rem; margin-top:1.75rem; flex-wrap:wrap; justify-content:center; }

/* DRAWER */
.dovl { position:fixed; inset:0; z-index:300; background:rgba(0,0,0,0); pointer-events:none; transition:background 0.3s; }
.dovl.open { background:rgba(0,0,0,0.72); pointer-events:all; }
.drawer { position:fixed; top:0; right:-440px; width:415px; max-width:95vw; height:100vh; background:var(--surface); border-left:1px solid var(--border2); z-index:400; transition:right 0.22s cubic-bezier(.3,0,.2,1); display:flex; flex-direction:column; overflow:hidden; }
.drawer.open { right:0; }
.dhead { padding:1.4rem 1.4rem 0.9rem; border-bottom:1px solid var(--border); display:flex; align-items:center; justify-content:space-between; flex-shrink:0; }
.dtitle { font-family:'Inter',sans-serif; font-size:1.05rem; font-weight:700; color:var(--text-1); }
.dclose {
  display: flex; align-items: center; justify-content: center;
  width: 28px; height: 28px;
  background: transparent;
  border: 1px solid var(--border2);
  border-radius: 6px;
  color: var(--text-3);
  cursor: none;
  transition: background 0.12s, color 0.12s;
  flex-shrink: 0;
}
.dclose:hover { background: var(--surface3); color: var(--text-1); }
.dclose .si svg { width: 11px; height: 11px; }
.dclose:hover { background:var(--surface3); color:var(--text-1); }
.dbody { flex:1; overflow-y:auto; padding:0.9rem 1.4rem 2rem; }
.dbody::-webkit-scrollbar { width:3px; }
.dbody::-webkit-scrollbar-thumb { background:var(--surface3); border-radius:2px; }
.dempty { text-align:center; padding:3rem 1rem; color:var(--text-3); font-size:0.85rem; line-height:1.7; }
.dempty-ico {
  display: flex; align-items: center; justify-content: center;
  margin-bottom: 0.65rem;
  color: var(--text-3);
  opacity: 0.45;
}
.dempty-ico .si svg { width: 28px; height: 28px; }
.hitem { background:var(--surface2); border:1px solid var(--border); border-radius:var(--r); padding:0.9rem 1rem; margin-bottom:0.42rem; cursor:none; transition:all 0.12s; position:relative; }
.hitem:hover { border-color:var(--border2); background:var(--surface3); }
.hidate { font-family:'JetBrains Mono',monospace; font-size:0.62rem; color:var(--text-3); margin-bottom:0.35rem; }
.histage { font-size:0.76rem; color:var(--text-2); font-weight:500; margin-bottom:0.28rem; }
.hiprev { font-size:0.77rem; color:var(--text-2); line-height:1.5; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
.hdel {
  position: absolute; top: 0.65rem; right: 0.65rem;
  display: flex; align-items: center; justify-content: center;
  width: 22px; height: 22px;
  background: transparent;
  border: 1px solid transparent;
  border-radius: 5px;
  color: var(--text-3);
  cursor: none;
  transition: background 0.1s, color 0.1s, border-color 0.1s;
}
.hdel:hover { background: var(--surface3); color: var(--text-1); border-color: var(--border2); }
.hdel .si svg { width: 10px; height: 10px; }
.hitem:hover .hdel {
  position: absolute; top: 0.65rem; right: 0.65rem;
  display: flex; align-items: center; justify-content: center;
  width: 22px; height: 22px;
  background: transparent;
  border: 1px solid transparent;
  border-radius: 5px;
  color: var(--text-3);
  cursor: none;
  transition: background 0.1s, color 0.1s, border-color 0.1s;
}
.hdel:hover { background: var(--surface3); color: var(--text-1); border-color: var(--border2); }
.hdel .si svg { width: 10px; height: 10px; }
.hdel:hover { background:var(--orange-dim); color:var(--orange); }

/* ── REVEAL CANVAS ── */
#reveal-canvas {
  position: fixed;
  inset: 0;
  width: 100%;
  height: 100%;
  z-index: 50;
  pointer-events: none;
  display: block;
  transition: opacity 0.9s cubic-bezier(0.4, 0, 0.2, 1);
}
#screen-intro:not(.active) #reveal-canvas {
  position: fixed;
  inset: 0;
  width: 100%;
  height: 100%;
  z-index: 50;
  pointer-events: none;
  display: block;
  transition: opacity 0.9s cubic-bezier(0.4, 0, 0.2, 1);
}

#reveal-hint {
  position: fixed;
  bottom: 2.8rem;
  left: 50%;
  transform: translateX(-50%);
  z-index: 55;
  pointer-events: none;
  display: flex;
  align-items: center;
  gap: 0.55rem;
  padding: 0.45rem 1rem;
  background: rgba(255,255,255,0.035);
  border: 1px solid rgba(255,255,255,0.07);
  border-radius: 100px;
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  transition: opacity 0.5s ease;
}
#reveal-hint .rh-dot {
  width: 5px; height: 5px;
  border-radius: 50%;
  background: var(--pink);
  animation: rhpulse 1.8s ease-in-out infinite;
}
#reveal-hint span {
  font-family: 'JetBrains Mono', monospace;
  font-size: 0.62rem;
  letter-spacing: 0.12em;
  text-transform: uppercase;
  color: rgba(237,237,240,0.38);
}
@keyframes rhpulse {
  0%, 100% { opacity: 0.35; transform: scale(1); }
  50% { opacity: 1; transform: scale(1.4); }
}
#reveal-hint.hidden { opacity: 0; }
#reveal-hint.hidden { opacity: 0; }

/* ── RESUME UPLOAD ── */
.resume-zone {
  margin-bottom: 2.2rem;
  animation: none;
}
.resume-label {
  font-size: 0.72rem;
  font-family: 'JetBrains Mono', monospace;
  text-transform: uppercase;
  letter-spacing: 0.12em;
  color: var(--text-3);
  margin-bottom: 0.65rem;
  display: flex;
  align-items: center;
  gap: 0.5rem;
}
.resume-label::before {
  content: '';
  display: block;
  width: 16px;
  height: 1px;
  background: var(--border2);
}
.resume-drop {
  border: 1.5px dashed var(--border2);
  border-radius: var(--r2);
  padding: 1.8rem 2rem;
  display: flex;
  align-items: center;
  gap: 1.1rem;
  cursor: none;
  transition: border-color 0.14s, background 0.14s;
  position: relative;
  overflow: hidden;
  background: var(--surface);
}
.resume-drop:hover,
.resume-drop.drag-active {
  border-color: rgba(139,92,246,0.45);
  background: var(--surface2);
}
.resume-drop input[type="file"] {
  position: absolute;
  inset: 0;
  opacity: 0;
  cursor: none;
  width: 100%;
  height: 100%;
}
.resume-icon {
  width: 38px; height: 38px;
  border-radius: 10px;
  background: var(--surface3);
  border: 1px solid var(--border2);
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 1rem;
  flex-shrink: 0;
  transition: background 0.14s, border-color 0.14s;
}
.resume-drop:hover .resume-icon,
.resume-drop.drag-active .resume-icon {
  background: var(--pink-dim);
  border-color: rgba(139,92,246,0.35);
}
.resume-copy { flex: 1; min-width: 0; }
.resume-copy-head {
  font-size: 0.88rem;
  font-weight: 600;
  color: var(--text-1);
  margin-bottom: 0.18rem;
}
.resume-copy-sub {
  font-size: 0.76rem;
  color: var(--text-3);
  line-height: 1.5;
}
.resume-skip {
  font-size: 0.72rem;
  color: var(--text-3);
  white-space: nowrap;
  flex-shrink: 0;
  font-family: 'JetBrains Mono', monospace;
}

/* loaded state */
.resume-drop.loaded {
  border-style: solid;
  border-color: rgba(110,231,183,0.4);
  background: rgba(110,231,183,0.04);
}
.resume-drop.loaded .resume-icon {
  background: rgba(110,231,183,0.12);
  border-color: rgba(110,231,183,0.3);
}
.resume-loaded-name {
  font-size: 0.84rem;
  font-weight: 600;
  color: var(--lime);
  margin-bottom: 0.1rem;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}
.resume-loaded-meta {
  font-size: 0.72rem;
  color: var(--text-3);
}
.resume-clear {
  font-size: 0.72rem;
  color: var(--text-3);
  background: none;
  border: none;
  cursor: none;
  padding: 0.2rem 0.4rem;
  border-radius: 4px;
  transition: color 0.12s, background 0.12s;
  flex-shrink: 0;
  font-family: 'JetBrains Mono', monospace;
  text-transform: uppercase;
  letter-spacing: 0.06em;
}
.resume-clear:hover {
  color: var(--orange);
  background: var(--orange-dim);
}

/* ── NO-RESUME CONFIRM MODAL ── */
.modal-ovl {
  position: fixed; inset: 0; z-index: 600;
  background: rgba(0,0,0,0);
  backdrop-filter: blur(0px);
  -webkit-backdrop-filter: blur(0px);
  display: flex; align-items: center; justify-content: center;
  padding: 1.5rem;
  pointer-events: none;
  transition: background 0.2s ease, backdrop-filter 0.2s ease;
}
.modal-ovl.open {
  background: rgba(0,0,0,0.6);
  backdrop-filter: blur(8px);
  -webkit-backdrop-filter: blur(8px);
  pointer-events: all;
}
.modal-box {
  background: var(--surface);
  border: 1px solid var(--border2);
  border-radius: 16px;
  padding: 2rem 2rem 1.75rem;
  max-width: 420px;
  width: 100%;
  position: relative;
  transform: translateY(14px) scale(0.97);
  opacity: 0;
  transition: transform 0.22s cubic-bezier(.3,0,.2,1), opacity 0.18s ease;
  box-shadow: 0 24px 64px rgba(0,0,0,0.5);
}
.modal-ovl.open .modal-box {
  transform: translateY(0) scale(1);
  opacity: 1;
}
.modal-icon {
  width: 44px; height: 44px;
  border-radius: 12px;
  background: var(--surface3);
  border: 1px solid var(--border2);
  display: flex; align-items: center; justify-content: center;
  font-size: 1.2rem;
  margin-bottom: 1.1rem;
}
.modal-title {
  font-size: 1rem;
  font-weight: 700;
  color: var(--text-1);
  letter-spacing: -0.3px;
  margin-bottom: 0.5rem;
  line-height: 1.35;
}
.modal-body {
  font-size: 0.84rem;
  color: var(--text-2);
  line-height: 1.65;
  margin-bottom: 1.5rem;
}
.modal-body strong {
  color: var(--text-1);
  font-weight: 600;
}
.modal-actions {
  display: flex;
  flex-direction: column;
  gap: 0.55rem;
}
.modal-btn-primary {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 0.5rem;
  padding: 0.78rem 1.4rem;
  background: var(--surface3);
  border: 1px solid var(--border2);
  border-radius: 8px;
  font-family: 'Inter', sans-serif;
  font-size: 0.86rem;
  font-weight: 600;
  color: var(--text-1);
  cursor: none;
  transition: background 0.12s ease, border-color 0.12s ease, transform 0.1s ease;
  width: 100%;
  text-align: center;
}
.modal-btn-primary:hover {
  background: #252530;
  border-color: rgba(139,92,246,0.4);
}
.modal-btn-primary:active {
  transform: scale(0.986);
}
.modal-btn-primary:focus-visible {
  outline: 2px solid rgba(139,92,246,0.6);
  outline-offset: 2px;
}
.modal-btn-secondary {
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 0.78rem 1.4rem;
  background: transparent;
  border: 1px solid transparent;
  border-radius: 8px;
  font-family: 'Inter', sans-serif;
  font-size: 0.84rem;
  font-weight: 500;
  color: var(--text-3);
  cursor: none;
  transition: color 0.12s ease, background 0.12s ease;
  width: 100%;
}
.modal-btn-secondary:hover {
  color: var(--text-2);
  background: var(--surface2);
}
.modal-btn-secondary:active {
  transform: scale(0.986);
}
.modal-divider {
  height: 1px;
  background: var(--border);
  margin: 0.2rem 0;
}
</style>
</head>
<body>

<div class="cursor" id="cursor"></div>
<div class="cursor-ring" id="cursor-ring"></div>
<div id="mouse-glow"></div>

<div id="animated-bg">
  <div class="bg-blob b1"></div>
  <div class="bg-blob b2"></div>
  <div class="bg-blob b3"></div>
  <div class="bg-blob b4"></div>
</div>
<div id="grid-overlay"></div>

<div class="dovl" id="dovl" onclick="closeDrawer()"></div>
<div class="drawer" id="drawer">
  <div class="dhead">
    <div class="dtitle">Past Profiles</div>
    <button class="dclose" onclick="closeDrawer()" aria-label="Close"><span class="si" aria-hidden="true"><svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"><path d="M4 4l8 8M12 4l-8 8"/></svg></span></button>
  </div>
  <div class="dbody" id="dbody">
    <div class="dempty"><div class="dempty-ico"><span class="si" aria-hidden="true"><svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M1.5 4.5A1.5 1.5 0 0 1 3 3h3l1.5 2H13A1.5 1.5 0 0 1 14.5 6.5v6A1.5 1.5 0 0 1 13 14H3A1.5 1.5 0 0 1 1.5 12.5z"/></svg></span></div>No saved profiles yet.<br>Complete the questionnaire to save your first career signal profile.</div>
  </div>
</div>

<!-- NO-RESUME MODAL -->
<div class="modal-ovl" id="modal-ovl">
  <div class="modal-box" id="modal-box">
    <div class="modal-icon"><span class="si lg" aria-hidden="true"><svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M3 2h7l3 3v9H3z"/><path d="M10 2v3h3"/><path d="M5 7h6M5 9.5h6M5 12h4"/></svg></span></div>
    <div class="modal-title">Continue without a resume?</div>
    <div class="modal-body">
      Your profile will be based <strong>entirely on your questionnaire answers</strong>. That works — but uploading a resume lets CareerSignal cross-reference your actual work history, compress timelines if you're already experienced, and produce sharper career fits.
      <br><br>You can always go back and add one.
    </div>
    <div class="modal-actions">
      <button class="modal-btn-primary" onclick="modalUpload()"><span class="si" aria-hidden="true"><svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M10 3L5 8l5 5"/></svg></span> <span class="btn-label">Upload a resume first</span></button>
      <div class="modal-divider"></div>
      <button class="modal-btn-secondary" onclick="modalProceed()"><span class="btn-label">Continue without resume</span> <span class="si" aria-hidden="true"><svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M6 3l5 5-5 5"/></svg></span></button>
    </div>
  </div>
</div>

<header>
  <div class="logo"><div class="logo-mark">CS</div>CareerSignal</div>
  <div class="header-right">
    <div class="hprog">
      <span id="plabel">Intro</span>
      <div class="ptrack"><div class="pfill" id="pfill"></div></div>
    </div>
    <button class="hist-btn" onclick="openDrawer()">
      <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
      History
      <span class="hcount" id="hcnt" style="display:none">0</span>
    </button>
  </div>
</header>

<main>

<!-- LANDING -->
<div class="screen active" id="screen-intro">
  <canvas id="reveal-canvas"></canvas>
  <div id="reveal-hint"><div class="rh-dot"></div><span>Move to uncover</span></div>
  <div class="landing-wrap">
    <div class="landing-badge">
      <div class="badge-icon"><svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.3" stroke-linecap="round" stroke-linejoin="round"><path d="M8 2v3M8 11v3M2 8h3M11 8h3M4.2 4.2l2.1 2.1M9.7 9.7l2.1 2.1M4.2 11.8l2.1-2.1M9.7 6.3l2.1-2.1"/></svg></div>
      AI Career Intelligence Engine
      <div class="badge-live"></div>
    </div>

    <h1 class="hero-label">Figure out what<br><span class="hero-grad">actually fits you.</span></h1>
    <div class="hero-sub">Not what sounds good.</div>

    <p class="hero-desc">Most career advice is embarrassingly generic. CareerSignal is a <em>structured behavioral deep-dive</em> that extracts your specific patterns — what genuinely energizes you, what drains you, how you actually work, and what you're willing to trade. The output isn't a personality type. It's a real profile with career fits and concrete break-in plans.</p>

    <div class="feature-grid">
      <div class="fcard">
        <div class="fc-icon" style="background:rgba(139,92,246,0.12);border:1px solid rgba(139,92,246,0.18)"><svg viewBox="0 0 24 24" fill="none" stroke="rgb(167,139,250)" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="7"/><line x1="21" y1="21" x2="16.65" y2="16.65"/><line x1="11" y1="8" x2="11" y2="14"/><line x1="8" y1="11" x2="14" y2="11"/></svg></div>
        <div class="fc-title">Behavioral Signal Extraction</div>
        <div class="fc-desc">We don't ask what you want to be. We analyze how you actually behave — flow states, energy patterns, real avoidances.</div>
      </div>
      <div class="fcard">
        <div class="fc-icon" style="background:rgba(96,165,250,0.1);border:1px solid rgba(96,165,250,0.16)"><svg viewBox="0 0 24 24" fill="none" stroke="rgb(96,165,250)" stroke-width="1.8" stroke-linecap="round"><circle cx="12" cy="12" r="9"/><circle cx="12" cy="12" r="5"/><circle cx="12" cy="12" r="1.5" fill="rgb(96,165,250)" stroke="none"/></svg></div>
        <div class="fc-title">Personalized Career Fits</div>
        <div class="fc-desc">4 career matches grounded in your real data — 2 primary, 2 exploratory — with match scores and salary ranges.</div>
      </div>
      <div class="fcard">
        <div class="fc-icon" style="background:rgba(110,231,183,0.1);border:1px solid rgba(110,231,183,0.16)"><svg viewBox="0 0 24 24" fill="none" stroke="rgb(110,231,183)" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M3 7l6-3 6 3 6-3v13l-6 3-6-3-6 3V7z"/><path d="M9 4v13"/><path d="M15 7v13"/></svg></div>
        <div class="fc-title">Concrete Break-In Roadmaps</div>
        <div class="fc-desc">Real platforms, certifications, timelines — not "network more." Each fit has a step-by-step entry plan.</div>
      </div>
      <div class="fcard">
        <div class="fc-icon" style="background:rgba(251,146,60,0.1);border:1px solid rgba(251,146,60,0.16)"><svg viewBox="0 0 24 24" fill="none" stroke="rgb(251,146,60)" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2L2 7l10 5 10-5-10-5z"/><path d="M2 17l10 5 10-5"/><path d="M2 12l10 5 10-5"/></svg></div>
        <div class="fc-title">History & Comparison</div>
        <div class="fc-desc">All profiles save locally. Retake in 6 months and compare — see how your signals shift over time.</div>
      </div>
    </div>

    <div class="how-wrap">
      <div class="how-eyebrow">How it works</div>
      <div class="steps">
        <div class="step">
          <span class="step-n">01</span>
          <div class="step-t">Answer 21 questions</div>
          <div class="step-d">Behavioral, not aspirational. ~15 min.</div>
        </div>
        <div class="step">
          <span class="step-n">02</span>
          <div class="step-t">AI extracts your signals</div>
          <div class="step-d">Patterns across energy, behavior & values.</div>
        </div>
        <div class="step">
          <span class="step-n">03</span>
          <div class="step-t">Get your profile</div>
          <div class="step-d">Career fits + roadmaps built for you.</div>
        </div>
      </div>
    </div>

    <div class="proof">
      <div class="avs">
        <div class="av av1">A</div>
        <div class="av av2">K</div>
        <div class="av av3">M</div>
        <div class="av av4">R</div>
      </div>
      <div class="proof-text"><strong>Thousands of people</strong> have used CareerSignal to find clarity on what career actually fits how they think and work.</div>
    </div>

    <div class="resume-zone">
      <div class="resume-label">Optional — upload your resume</div>
      <div class="resume-drop" id="resume-drop">
        <input type="file" id="resume-file" accept=".pdf,.txt,.doc,.docx" onchange="handleResumeFile(this.files[0]);this.value=''">
        <div class="resume-icon" id="resume-icon"><span class="si lg" aria-hidden="true"><svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M3 2h7l3 3v9H3z"/><path d="M10 2v3h3"/><path d="M5 7h6M5 9.5h6M5 12h4"/></svg></span></div>
        <div class="resume-copy" id="resume-copy">
          <div class="resume-copy-head">Drop your resume here</div>
          <div class="resume-copy-sub">PDF, TXT, DOC · CareerSignal uses it to ground your profile in your real experience</div>
        </div>
        <div class="resume-skip" id="resume-skip">optional</div>
      </div>
    </div>

    <div class="cta-row">
      <button class="btn btn-a btn-lg" onclick="tryStart()"><span class="btn-label">Start for free</span> <span class="si" aria-hidden="true"><svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M6 3l5 5-5 5"/></svg></span></button>
      <div class="meta-list">
        <div class="mpill"><div class="mpdot"></div>~15 min</div>
        <div class="mpill"><div class="mpdot"></div>No signup</div>
        <div class="mpill"><div class="mpdot"></div>Free forever</div>
      </div>
    </div>
  </div>
</div>

<!-- S1 -->
<div class="screen" id="screen-s1">
  <div class="s-eye">Section 1 of 6</div>
  <h2 class="s-title">Where you are right now</h2>
  <p class="s-sub">Context before depth. Be honest — this calibrates everything else.</p>
  <div class="qb">
    <div class="qn">Q1</div><div class="qt">Which best describes your current situation?</div>
    <div class="rg" id="q1">
      <label class="ropt" onclick="selR(this,'q1')"><input type="radio"><div class="oring"></div><div class="olabel"><strong>High school</strong><small>Figuring out where I want to go</small></div></label>
      <label class="ropt" onclick="selR(this,'q1')"><input type="radio"><div class="oring"></div><div class="olabel"><strong>College / university</strong><small>Studying, thinking about what's next</small></div></label>
      <label class="ropt" onclick="selR(this,'q1')"><input type="radio"><div class="oring"></div><div class="olabel"><strong>Recent graduate (0–2 years out)</strong><small>Just starting out</small></div></label>
      <label class="ropt" onclick="selR(this,'q1')"><input type="radio"><div class="oring"></div><div class="olabel"><strong>Working professional — growing in place</strong><small>Advancing within my field</small></div></label>
      <label class="ropt" onclick="selR(this,'q1')"><input type="radio"><div class="oring"></div><div class="olabel"><strong>Working professional — considering a switch</strong><small>Something feels off; exploring alternatives</small></div></label>
    </div>
  </div>
  <div class="qb"><div class="qn">Q2</div><div class="qt">How old are you?</div><input type="number" id="q2" placeholder="e.g. 27" min="14" max="75"></div>
  <div class="qb">
    <div class="qn">Q3</div><div class="qt">What's your financial runway right now?</div>
    <div class="qh">How long could you sustain yourself without any new income?</div>
    <div class="rg" id="q3">
      <label class="ropt" onclick="selR(this,'q3')"><input type="radio"><div class="oring"></div><div class="olabel">Less than 1 month</div></label>
      <label class="ropt" onclick="selR(this,'q3')"><input type="radio"><div class="oring"></div><div class="olabel">1–3 months</div></label>
      <label class="ropt" onclick="selR(this,'q3')"><input type="radio"><div class="oring"></div><div class="olabel">3–6 months</div></label>
      <label class="ropt" onclick="selR(this,'q3')"><input type="radio"><div class="oring"></div><div class="olabel">6–12 months</div></label>
      <label class="ropt" onclick="selR(this,'q3')"><input type="radio"><div class="oring"></div><div class="olabel">12+ months</div></label>
    </div>
  </div>
  <div class="qb"><div class="qn">Q4</div><div class="qt">Minimum annual salary you'd need to accept a role?</div><div class="qh">Not your dream — the floor below which you wouldn't take a job.</div><input type="number" id="q4" placeholder="e.g. 65000"></div>
  <div class="navrow">
    <button class="btn btn-g" onclick="goTo('screen-intro')"><span class="si" aria-hidden="true"><svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M10 3L5 8l5 5"/></svg></span> <span class="btn-label">Back</span></button>
    <button class="btn btn-p" onclick="goTo('screen-s2')"><span class="btn-label">Next</span> <span class="si" aria-hidden="true"><svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M6 3l5 5-5 5"/></svg></span></button>
  </div>
</div>

<!-- S2 -->
<div class="screen" id="screen-s2">
  <div class="s-eye">Section 2 of 6</div>
  <h2 class="s-title">What gives you energy</h2>
  <p class="s-sub">Think about moments where time disappeared. What was actually happening?</p>
  <div class="qb"><div class="qn">Q5</div><div class="qt">Describe the last time you were completely absorbed in a task.</div><div class="qh">Be specific — "analyzing spreadsheet data" beats "something interesting."</div><textarea id="q5" placeholder="e.g. I was building a model in Excel to forecast inventory — I kept refining the formulas for 3 hours without noticing…"></textarea></div>
  <div class="qb">
    <div class="qn">Q6</div><div class="qt">What types of problems feel genuinely satisfying to solve?</div>
    <div class="qh">Pick all that feel true — not what you're "supposed" to like.</div>
    <div class="cg" id="q6">
      <div class="copt" onclick="selC(this)"><div class="oring"></div><div class="olabel">Figuring out why something broke and fixing it</div></div>
      <div class="copt" onclick="selC(this)"><div class="oring"></div><div class="olabel">Making something unclear into something clear (explaining, writing, simplifying)</div></div>
      <div class="copt" onclick="selC(this)"><div class="oring"></div><div class="olabel">Getting people aligned on something complicated</div></div>
      <div class="copt" onclick="selC(this)"><div class="oring"></div><div class="olabel">Optimizing a process so it runs faster or cheaper</div></div>
      <div class="copt" onclick="selC(this)"><div class="oring"></div><div class="olabel">Finding patterns in data others missed</div></div>
      <div class="copt" onclick="selC(this)"><div class="oring"></div><div class="olabel">Creating something new that didn't exist before</div></div>
      <div class="copt" onclick="selC(this)"><div class="oring"></div><div class="olabel">Helping a specific person work through their problem</div></div>
      <div class="copt" onclick="selC(this)"><div class="oring"></div><div class="olabel">Arguing or persuading — winning someone over logically</div></div>
    </div>
  </div>
  <div class="qb"><div class="qn">Q7</div><div class="qt">What tasks reliably drain you — even when capable?</div><div class="qh">Things you avoid, procrastinate on, or feel exhausted by.</div><textarea id="q7" placeholder="e.g. Repetitive data entry, small talk in large groups, following rigid process without understanding why…"></textarea></div>
  <div class="qb">
    <div class="qn">Q8</div><div class="qt">When you do your best work, alone or with others?</div>
    <div class="rg" id="q8">
      <label class="ropt" onclick="selR(this,'q8')"><input type="radio"><div class="oring"></div><div class="olabel"><strong>Alone</strong><small>Deep focus, no interruptions</small></div></label>
      <label class="ropt" onclick="selR(this,'q8')"><input type="radio"><div class="oring"></div><div class="olabel"><strong>Mostly alone, occasional collaboration</strong><small>Independent but I check in</small></div></label>
      <label class="ropt" onclick="selR(this,'q8')"><input type="radio"><div class="oring"></div><div class="olabel"><strong>Mix of both</strong><small>Depends on the task</small></div></label>
      <label class="ropt" onclick="selR(this,'q8')"><input type="radio"><div class="oring"></div><div class="olabel"><strong>Mostly with others</strong><small>I think better out loud</small></div></label>
      <label class="ropt" onclick="selR(this,'q8')"><input type="radio"><div class="oring"></div><div class="olabel"><strong>Always with others</strong><small>Solo work kills my motivation</small></div></label>
    </div>
  </div>
  <div class="navrow">
    <button class="btn btn-g" onclick="goTo('screen-s1')"><span class="si" aria-hidden="true"><svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M10 3L5 8l5 5"/></svg></span> <span class="btn-label">Back</span></button>
    <button class="btn btn-p" onclick="goTo('screen-s3')"><span class="btn-label">Next</span> <span class="si" aria-hidden="true"><svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M6 3l5 5-5 5"/></svg></span></button>
  </div>
</div>

<!-- S3 -->
<div class="screen" id="screen-s3">
  <div class="s-eye">Section 3 of 6</div>
  <h2 class="s-title">How you actually work</h2>
  <p class="s-sub">Not how you wish you worked — how you behave left to your own devices.</p>
  <div class="qb">
    <div class="qn">Q9</div><div class="qt">When you start something new with no instructions?</div>
    <div class="rg" id="q9">
      <label class="ropt" onclick="selR(this,'q9')"><input type="radio"><div class="oring"></div><div class="olabel"><strong>Dive in and figure it out</strong><small>Trial and error is how I learn fastest</small></div></label>
      <label class="ropt" onclick="selR(this,'q9')"><input type="radio"><div class="oring"></div><div class="olabel"><strong>Research first, then start</strong><small>I want to understand the landscape before acting</small></div></label>
      <label class="ropt" onclick="selR(this,'q9')"><input type="radio"><div class="oring"></div><div class="olabel"><strong>Look for a framework or template</strong><small>I like a structure to adapt from</small></div></label>
      <label class="ropt" onclick="selR(this,'q9')"><input type="radio"><div class="oring"></div><div class="olabel"><strong>Ask someone who's done it before</strong><small>Human guidance beats documentation</small></div></label>
      <label class="ropt" onclick="selR(this,'q9')"><input type="radio"><div class="oring"></div><div class="olabel"><strong>Feel stuck until I get more clarity</strong><small>Ambiguity genuinely slows me down</small></div></label>
    </div>
  </div>
  <div class="qb">
    <div class="qn">Q10</div><div class="qt">How do you react to high-pressure situations?</div>
    <div class="rg" id="q10">
      <label class="ropt" onclick="selR(this,'q10')"><input type="radio"><div class="oring"></div><div class="olabel"><strong>Thrive</strong><small>Pressure sharpens my focus and output</small></div></label>
      <label class="ropt" onclick="selR(this,'q10')"><input type="radio"><div class="oring"></div><div class="olabel"><strong>Handle it, prefer steady pace</strong><small>I can do it, but it takes a toll</small></div></label>
      <label class="ropt" onclick="selR(this,'q10')"><input type="radio"><div class="oring"></div><div class="olabel"><strong>Depends on the stakes</strong><small>Some pressure energizes, some doesn't</small></div></label>
      <label class="ropt" onclick="selR(this,'q10')"><input type="radio"><div class="oring"></div><div class="olabel"><strong>Struggle</strong><small>Pressure tends to degrade my thinking</small></div></label>
    </div>
  </div>
  <div class="qb">
    <div class="qn">Q11</div><div class="qt">Rate yourself honestly. (1 = strongly disagree · 5 = strongly agree)</div>
    <div style="display:flex;flex-direction:column;gap:1.1rem;">
      <div>
        <div style="font-size:0.86rem;font-weight:600;color:var(--text-1);margin-bottom:0.45rem;">"I prefer making my own decisions over being told what to do."</div>
        <div class="scwrap" id="q11a"><button class="scbtn" onclick="selSc(this,'q11a')">1</button><button class="scbtn" onclick="selSc(this,'q11a')">2</button><button class="scbtn" onclick="selSc(this,'q11a')">3</button><button class="scbtn" onclick="selSc(this,'q11a')">4</button><button class="scbtn" onclick="selSc(this,'q11a')">5</button></div>
        <div class="sclabs"><span>Strongly disagree</span><span>Strongly agree</span></div>
      </div>
      <div>
        <div style="font-size:0.86rem;font-weight:600;color:var(--text-1);margin-bottom:0.45rem;">"I do my best work when I have clear structure and expectations."</div>
        <div class="scwrap" id="q11b"><button class="scbtn" onclick="selSc(this,'q11b')">1</button><button class="scbtn" onclick="selSc(this,'q11b')">2</button><button class="scbtn" onclick="selSc(this,'q11b')">3</button><button class="scbtn" onclick="selSc(this,'q11b')">4</button><button class="scbtn" onclick="selSc(this,'q11b')">5</button></div>
        <div class="sclabs"><span>Strongly disagree</span><span>Strongly agree</span></div>
      </div>
    </div>
  </div>
  <div class="qb">
    <div class="qn">Q12</div><div class="qt">When motivated, how quickly do you reach competence?</div>
    <div class="rg" id="q12">
      <label class="ropt" onclick="selR(this,'q12')"><input type="radio"><div class="oring"></div><div class="olabel"><strong>Weeks</strong><small>I pick things up very fast when I'm into it</small></div></label>
      <label class="ropt" onclick="selR(this,'q12')"><input type="radio"><div class="oring"></div><div class="olabel"><strong>A few months</strong><small>Moderate ramp, steady progress</small></div></label>
      <label class="ropt" onclick="selR(this,'q12')"><input type="radio"><div class="oring"></div><div class="olabel"><strong>Six months to a year</strong><small>I go deep before I feel confident</small></div></label>
      <label class="ropt" onclick="selR(this,'q12')"><input type="radio"><div class="oring"></div><div class="olabel"><strong>Varies a lot by domain</strong></div></label>
    </div>
  </div>
  <div class="navrow">
    <button class="btn btn-g" onclick="goTo('screen-s2')"><span class="si" aria-hidden="true"><svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M10 3L5 8l5 5"/></svg></span> <span class="btn-label">Back</span></button>
    <button class="btn btn-p" onclick="goTo('screen-s4')"><span class="btn-label">Next</span> <span class="si" aria-hidden="true"><svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M6 3l5 5-5 5"/></svg></span></button>
  </div>
</div>

<!-- S4 -->
<div class="screen" id="screen-s4">
  <div class="s-eye">Section 4 of 6</div>
  <h2 class="s-title">What actually motivates you</h2>
  <p class="s-sub">Not what sounds good in interviews. What genuinely drives your best work.</p>
  <div class="qb"><div class="qn">Q13</div><div class="qt">Think of a project you're actually proud of. What made it satisfying?</div><div class="qh">Don't describe the outcome — describe the experience of doing the work.</div><textarea id="q13" placeholder="e.g. I had full control over the approach, I could see my decisions having real impact…"></textarea></div>
  <div class="qb">
    <div class="qn">Q14</div><div class="qt">Rank these motivators (most → least important):</div>
    <div class="rank-hint"><span class="si" aria-hidden="true"><svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"><circle cx="5.5" cy="4" r="0.75" fill="currentColor" stroke="none"/><circle cx="5.5" cy="8" r="0.75" fill="currentColor" stroke="none"/><circle cx="5.5" cy="12" r="0.75" fill="currentColor" stroke="none"/><circle cx="10.5" cy="4" r="0.75" fill="currentColor" stroke="none"/><circle cx="10.5" cy="8" r="0.75" fill="currentColor" stroke="none"/><circle cx="10.5" cy="12" r="0.75" fill="currentColor" stroke="none"/></svg></span>Drag to reorder — top = most important</div>
    <div id="q14r" class="rank-list">
      <div class="rank-item" data-val="Compensation — earning well"><span class="rank-grip"><svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"><circle cx="5.5" cy="4" r="0.75" fill="currentColor" stroke="none"/><circle cx="5.5" cy="8" r="0.75" fill="currentColor" stroke="none"/><circle cx="5.5" cy="12" r="0.75" fill="currentColor" stroke="none"/><circle cx="10.5" cy="4" r="0.75" fill="currentColor" stroke="none"/><circle cx="10.5" cy="8" r="0.75" fill="currentColor" stroke="none"/><circle cx="10.5" cy="12" r="0.75" fill="currentColor" stroke="none"/></svg></span><span class="rank-pos">1</span><span class="rank-label">Compensation — earning well</span></div>
      <div class="rank-item" data-val="Impact — making a real difference"><span class="rank-grip"><svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"><circle cx="5.5" cy="4" r="0.75" fill="currentColor" stroke="none"/><circle cx="5.5" cy="8" r="0.75" fill="currentColor" stroke="none"/><circle cx="5.5" cy="12" r="0.75" fill="currentColor" stroke="none"/><circle cx="10.5" cy="4" r="0.75" fill="currentColor" stroke="none"/><circle cx="10.5" cy="8" r="0.75" fill="currentColor" stroke="none"/><circle cx="10.5" cy="12" r="0.75" fill="currentColor" stroke="none"/></svg></span><span class="rank-pos">2</span><span class="rank-label">Impact — making a real difference</span></div>
      <div class="rank-item" data-val="Autonomy — control over my own work"><span class="rank-grip"><svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"><circle cx="5.5" cy="4" r="0.75" fill="currentColor" stroke="none"/><circle cx="5.5" cy="8" r="0.75" fill="currentColor" stroke="none"/><circle cx="5.5" cy="12" r="0.75" fill="currentColor" stroke="none"/><circle cx="10.5" cy="4" r="0.75" fill="currentColor" stroke="none"/><circle cx="10.5" cy="8" r="0.75" fill="currentColor" stroke="none"/><circle cx="10.5" cy="12" r="0.75" fill="currentColor" stroke="none"/></svg></span><span class="rank-pos">3</span><span class="rank-label">Autonomy — control over my own work</span></div>
      <div class="rank-item" data-val="Mastery — getting really good at something"><span class="rank-grip"><svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"><circle cx="5.5" cy="4" r="0.75" fill="currentColor" stroke="none"/><circle cx="5.5" cy="8" r="0.75" fill="currentColor" stroke="none"/><circle cx="5.5" cy="12" r="0.75" fill="currentColor" stroke="none"/><circle cx="10.5" cy="4" r="0.75" fill="currentColor" stroke="none"/><circle cx="10.5" cy="8" r="0.75" fill="currentColor" stroke="none"/><circle cx="10.5" cy="12" r="0.75" fill="currentColor" stroke="none"/></svg></span><span class="rank-pos">4</span><span class="rank-label">Mastery — getting really good at something</span></div>
      <div class="rank-item" data-val="Recognition — being seen and respected"><span class="rank-grip"><svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"><circle cx="5.5" cy="4" r="0.75" fill="currentColor" stroke="none"/><circle cx="5.5" cy="8" r="0.75" fill="currentColor" stroke="none"/><circle cx="5.5" cy="12" r="0.75" fill="currentColor" stroke="none"/><circle cx="10.5" cy="4" r="0.75" fill="currentColor" stroke="none"/><circle cx="10.5" cy="8" r="0.75" fill="currentColor" stroke="none"/><circle cx="10.5" cy="12" r="0.75" fill="currentColor" stroke="none"/></svg></span><span class="rank-pos">5</span><span class="rank-label">Recognition — being seen and respected</span></div>
      <div class="rank-item" data-val="Stability — predictability and security"><span class="rank-grip"><svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"><circle cx="5.5" cy="4" r="0.75" fill="currentColor" stroke="none"/><circle cx="5.5" cy="8" r="0.75" fill="currentColor" stroke="none"/><circle cx="5.5" cy="12" r="0.75" fill="currentColor" stroke="none"/><circle cx="10.5" cy="4" r="0.75" fill="currentColor" stroke="none"/><circle cx="10.5" cy="8" r="0.75" fill="currentColor" stroke="none"/><circle cx="10.5" cy="12" r="0.75" fill="currentColor" stroke="none"/></svg></span><span class="rank-pos">6</span><span class="rank-label">Stability — predictability and security</span></div>
    </div>
  </div>
  <div class="qb"><div class="qn">Q15</div><div class="qt">If money didn't matter, how would you spend your time?</div><textarea id="q15" placeholder="e.g. I'd still build things for people who need them — probably in education or health tech…"></textarea></div>
  <div class="navrow">
    <button class="btn btn-g" onclick="goTo('screen-s3')"><span class="si" aria-hidden="true"><svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M10 3L5 8l5 5"/></svg></span> <span class="btn-label">Back</span></button>
    <button class="btn btn-p" onclick="goTo('screen-s5')"><span class="btn-label">Next</span> <span class="si" aria-hidden="true"><svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M6 3l5 5-5 5"/></svg></span></button>
  </div>
</div>

<!-- S5 -->
<div class="screen" id="screen-s5">
  <div class="s-eye">Section 5 of 6</div>
  <h2 class="s-title">What you're willing to trade</h2>
  <p class="s-sub">Every career path involves tradeoffs. Be honest about your real tolerances.</p>
  <div class="qb">
    <div class="qn">Q16</div><div class="qt">For each tradeoff, which side do you lean toward?</div>
    <div style="display:flex;flex-direction:column;gap:0.6rem;margin-top:0.5rem;">
      <div class="tgroup"><div class="tghead">Compensation vs. Mission</div><div class="tgopts" id="q16a"><label class="ropt" style="flex:1" onclick="selR(this,'q16a')"><input type="radio"><div class="oring"></div><div class="olabel">Higher pay, less mission</div></label><label class="ropt" style="flex:1" onclick="selR(this,'q16a')"><input type="radio"><div class="oring"></div><div class="olabel">Lower pay, stronger mission</div></label></div></div>
      <div class="tgroup"><div class="tghead">Stability vs. Growth</div><div class="tgopts" id="q16b"><label class="ropt" style="flex:1" onclick="selR(this,'q16b')"><input type="radio"><div class="oring"></div><div class="olabel">Predictable path</div></label><label class="ropt" style="flex:1" onclick="selR(this,'q16b')"><input type="radio"><div class="oring"></div><div class="olabel">Faster growth, higher risk</div></label></div></div>
      <div class="tgroup"><div class="tghead">Individual Contributor vs. Management</div><div class="tgopts" id="q16c"><label class="ropt" style="flex:1" onclick="selR(this,'q16c')"><input type="radio"><div class="oring"></div><div class="olabel">Deep IC work</div></label><label class="ropt" style="flex:1" onclick="selR(this,'q16c')"><input type="radio"><div class="oring"></div><div class="olabel">Leading people</div></label></div></div>
      <div class="tgroup"><div class="tghead">Defined Role vs. Open-Ended</div><div class="tgopts" id="q16d"><label class="ropt" style="flex:1" onclick="selR(this,'q16d')"><input type="radio"><div class="oring"></div><div class="olabel">Clear scope, defined path</div></label><label class="ropt" style="flex:1" onclick="selR(this,'q16d')"><input type="radio"><div class="oring"></div><div class="olabel">Ambiguous, higher upside</div></label></div></div>
    </div>
  </div>
  <div class="qb"><div class="qn">Q17</div><div class="qt">What is the one thing you're genuinely unwilling to sacrifice?</div><div class="qh">There's usually one hard line. What is yours?</div><textarea id="q17" placeholder="e.g. I won't trade flexibility — I need to work on my own schedule, even if it means lower pay…"></textarea></div>
  <div class="navrow">
    <button class="btn btn-g" onclick="goTo('screen-s4')"><span class="si" aria-hidden="true"><svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M10 3L5 8l5 5"/></svg></span> <span class="btn-label">Back</span></button>
    <button class="btn btn-p" onclick="goTo('screen-s6')"><span class="btn-label">Next</span> <span class="si" aria-hidden="true"><svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M6 3l5 5-5 5"/></svg></span></button>
  </div>
</div>

<!-- S6 -->
<div class="screen" id="screen-s6">
  <div class="s-eye">Section 6 of 6</div>
  <h2 class="s-title">Your real constraints</h2>
  <p class="s-sub">Interests matter, but constraints shape what's actually possible. Be precise.</p>
  <div class="qb"><div class="qn">Q18</div><div class="qt">Where are you located / willing to work?</div><input type="text" id="q18" placeholder="e.g. New York City, open to remote, not willing to relocate"></div>
  <div class="qb">
    <div class="qn">Q19</div><div class="qt">Work authorization status?</div>
    <div class="rg" id="q19">
      <label class="ropt" onclick="selR(this,'q19')"><input type="radio"><div class="oring"></div><div class="olabel">Citizen or permanent resident — no restrictions</div></label>
      <label class="ropt" onclick="selR(this,'q19')"><input type="radio"><div class="oring"></div><div class="olabel">Work visa (OPT, H-1B, etc.) — need sponsorship eventually</div></label>
      <label class="ropt" onclick="selR(this,'q19')"><input type="radio"><div class="oring"></div><div class="olabel">Student visa — limited work rights</div></label>
      <label class="ropt" onclick="selR(this,'q19')"><input type="radio"><div class="oring"></div><div class="olabel">Currently restricted / other</div></label>
    </div>
  </div>
  <div class="qb">
    <div class="qn">Q20</div><div class="qt">How many hours per week are you available?</div>
    <div class="rg" id="q20">
      <label class="ropt" onclick="selR(this,'q20')"><input type="radio"><div class="oring"></div><div class="olabel">Under 20 hrs/week — part-time or freelance only</div></label>
      <label class="ropt" onclick="selR(this,'q20')"><input type="radio"><div class="oring"></div><div class="olabel">20–35 hrs/week — reduced full-time</div></label>
      <label class="ropt" onclick="selR(this,'q20')"><input type="radio"><div class="oring"></div><div class="olabel">40 hrs/week — standard full-time</div></label>
      <label class="ropt" onclick="selR(this,'q20')"><input type="radio"><div class="oring"></div><div class="olabel">50+ hrs/week — open to demanding roles</div></label>
    </div>
  </div>
  <div class="qb"><div class="qn">Q21</div><div class="qt">Anything else that should factor into your profile?</div><div class="qh">Caregiving, health, required industry, non-negotiable values, etc.</div><textarea id="q21" placeholder="e.g. I have two kids so commuting more than 45 min is off the table. I also won't work for companies in defense or tobacco…"></textarea></div>
  <div class="navrow">
    <button class="btn btn-g" onclick="goTo('screen-s5')"><span class="si" aria-hidden="true"><svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M10 3L5 8l5 5"/></svg></span> <span class="btn-label">Back</span></button>
    <button class="btn btn-a btn-lg" id="submit-btn" onclick="submitQ()"><span class="btn-spinner"></span><span class="btn-label">Analyze my signals</span> <span class="si" aria-hidden="true"><svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M6 3l5 5-5 5"/></svg></span></button>
  </div>
</div>

<!-- LOADING -->
<div class="screen" id="screen-loading">
  <div class="lwrap">
    <div class="sring"></div>
    <div class="ltitle">Extracting your career signals</div>
    <div class="lsub">This usually takes 15–30 seconds</div>
    <div class="lsteps">
      <div class="lstep" id="ls1"><div class="sbul">1</div><span id="ls1-text">Parsing questionnaire responses</span></div>
      <div class="lstep" id="ls2"><div class="sbul">2</div><span>Identifying behavioral patterns</span></div>
      <div class="lstep" id="ls3"><div class="sbul">3</div><span>Inferring energy and motivation signals</span></div>
      <div class="lstep" id="ls4"><div class="sbul">4</div><span>Mapping constraints and tradeoffs</span></div>
      <div class="lstep" id="ls5"><div class="sbul">5</div><span>Generating career fit matches</span></div>
      <div class="lstep" id="ls6"><div class="sbul">6</div><span>Building break-in roadmaps</span></div>
    </div>
  </div>
</div>

<!-- RESULT -->
<div class="screen" id="screen-result">
  <div class="rhero">
    <div class="rkicker">Career Signal Profile</div>
    <div class="rtitle">Signal extraction complete</div>
    <div class="rsub">Grounded in your behavioral responses — not generic categories</div>
    <div class="mrow" id="mrow"></div>
  </div>
  <div id="rcontent"></div>
  <hr class="div">
  <div id="debug-section" style="display:none"  class="pcard">
    <div class="chead"><div class="clabel"><span class="si" aria-hidden="true"><svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><circle cx="8" cy="8" r="5.5"/><path d="M8 2.5v2M8 11.5v2M2.5 8h2M11.5 8h2"/><circle cx="8" cy="8" r="1.5" fill="currentColor" stroke="none"/></svg></span>Raw JSON Output</div></div>
    <p style="font-size:0.79rem;color:var(--text-3);margin-bottom:0.9rem;">Copy this into your career matching tool or downstream AI prompt for synthesis.</p>
    <div class="jblock"><button class="copybtn" onclick="copyJSON()">Copy</button><pre id="jpre"></pre></div>
  </div>
  <div class="ract">
    <button class="btn btn-g" onclick="startOver()">Start over</button>
    <button class="btn btn-p" onclick="openDrawer()">View history</button>
  </div>
</div>

</main>

<script>
// ── CURSOR + GLOW ──
const cursor = document.getElementById('cursor');
const ring = document.getElementById('cursor-ring');
const glow = document.getElementById('mouse-glow');
let mx=window.innerWidth/2, my=window.innerHeight/2, rx=mx, ry=my;

// Safe no-op until initReveal sets the real implementation
window.revealAt = function() {};

document.addEventListener('mousemove', e => {
  mx = e.clientX; my = e.clientY;
  if (cursor) { cursor.style.left = mx+'px'; cursor.style.top = my+'px'; }
  if (glow) { glow.style.left = mx+'px'; glow.style.top = my+'px'; }
  window.revealAt(mx, my);
});
(function animRing() {
  rx += (mx-rx)*0.18; ry += (my-ry)*0.18;
  if (ring) { ring.style.left = rx+'px'; ring.style.top = ry+'px'; }
  requestAnimationFrame(animRing);
})();

// ── LANDING REVEAL ──
(function initReveal() {
  const cvs = document.getElementById('reveal-canvas');
  const hint = document.getElementById('reveal-hint');
  if (!cvs) { window.revealAt = function(){}; return; }

  const RADIUS = 92;          // satisfying brush — discoverable but not trivial
  const FEATHER = 58;         // wide smooth feather for organic edge
  const BG = '#0c0c0f';       // must match --bg

  let ctx, W, H, revealed = false, dismissed = false, active = true;

  function resize() {
    W = cvs.width  = window.innerWidth;
    H = cvs.height = window.innerHeight;
    if (!revealed) fill();
  }

  function fill() {
    if (!ctx) return;
    ctx.globalCompositeOperation = 'source-over';
    ctx.fillStyle = BG;
    ctx.fillRect(0, 0, W, H);
  }

  function erase(x, y) {
    if (!ctx || !active) return;
    ctx.globalCompositeOperation = 'destination-out';
    const total = RADIUS + FEATHER;
    const g = ctx.createRadialGradient(x, y, 0, x, y, total);
    g.addColorStop(0,    'rgba(0,0,0,1)');
    g.addColorStop(0.42, 'rgba(0,0,0,1)');
    g.addColorStop(0.68, 'rgba(0,0,0,0.82)');
    g.addColorStop(0.86, 'rgba(0,0,0,0.35)');
    g.addColorStop(1,    'rgba(0,0,0,0)');
    ctx.fillStyle = g;
    ctx.beginPath();
    ctx.arc(x, y, total, 0, Math.PI * 2);
    ctx.fill();
  }

  function checkFullyRevealed() {
    try {
      const sample = ctx.getImageData(0, 0, W, H);
      const data = sample.data;
      let transparent = 0, total = 0;
      for (let i = 3; i < data.length; i += 32 * 4) {
        if (data[i] < 20) transparent++;
        total++;
      }
      if (transparent / total > 0.82) {
        revealed = true;
        active = false;
        cvs.style.transition = 'opacity 0.8s ease';
        cvs.style.opacity = '0';
        setTimeout(() => { cvs.style.display = 'none'; }, 850);
      }
    } catch(e) {
      // SecurityError on tainted canvas — just dissolve
      revealed = true; active = false;
      cvs.style.display = 'none';
    }
  }

  // init
  ctx = cvs.getContext('2d');
  resize();
  window.addEventListener('resize', resize);

  // dismiss hint on first move
  let hintDismissed = false;

  let moveCount = 0;
  window.revealAt = function(x, y) {
    if (!active) return;
    if (!hintDismissed && hint) {
      hint.classList.add('hidden');
      hintDismissed = true;
    }
    erase(x, y);
    moveCount++;
    if (moveCount % 40 === 0) checkFullyRevealed();
  };

  // hide canvas when leaving landing screen
  const origGoTo = window.goTo;
  // goTo is defined after this block, so we patch it post-init
  document.addEventListener('_goTo', (e) => {
    if (e.detail !== 'screen-intro') {
      active = false;
      cvs.style.display = 'none';
      if (hint) hint.style.display = 'none';
    } else {
      // returning to landing — reset
      active = true;
      revealed = false;
      hintDismissed = false;
      moveCount = 0;
      cvs.style.display = 'block';
      cvs.style.opacity = '1';
      if (hint) { hint.style.display = ''; hint.classList.remove('hidden'); }
      resize();
    }
  });
})();

// ── NAV ──
const SCREENS  = ['screen-intro','screen-s1','screen-s2','screen-s3','screen-s4','screen-s5','screen-s6','screen-loading','screen-result'];
const LABELS   = ['Intro','Context','Energy','Behavior','Motivation','Tradeoffs','Constraints','Analyzing…','Your Profile'];
const PROGRESS = [0,14,28,42,57,71,85,95,100];

function goTo(id) {
  const target = document.getElementById(id);
  if (!target) { console.warn('goTo: screen not found:', id); return; }
  document.querySelectorAll('.screen').forEach(s=>s.classList.remove('active'));
  target.classList.add('active');
  const i=SCREENS.indexOf(id);
  if(i>=0){
    const pfill=document.getElementById('pfill');
    const plabel=document.getElementById('plabel');
    if(pfill) pfill.style.width=PROGRESS[i]+'%';
    if(plabel) plabel.textContent=LABELS[i];
  }
  window.scrollTo({top:0,behavior:'smooth'});
  document.dispatchEvent(new CustomEvent('_goTo', {detail: id}));
}

// ── RESUME PARSING ──
let resumeText = '';
let resumeFileName = '';

// Load PDF.js once on demand
async function ensurePDFJS() {
  if (window.pdfjsLib) return;
  await new Promise((res, rej) => {
    const s = document.createElement('script');
    s.src = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js';
    s.onload = () => { window.pdfjsLib.GlobalWorkerOptions.workerSrc = ''; res(); };
    s.onerror = () => rej(new Error('Failed to load PDF.js'));
    document.head.appendChild(s);
  });
}

// PDF: extract text content page by page
async function extractPDFText(file) {
  await ensurePDFJS();
  const buf = await file.arrayBuffer();
  const pdf = await pdfjsLib.getDocument({ data: new Uint8Array(buf) }).promise;
  let text = '';
  for (let i = 1; i <= Math.min(pdf.numPages, 8); i++) {
    const page = await pdf.getPage(i);
    const tc   = await page.getTextContent();
    text += tc.items.map(it => it.str + (it.hasEOL ? '\n' : ' ')).join('') + '\n';
  }
  return text.trim();
}

// DOCX: unpack ZIP in-browser, extract <w:t> runs from word/document.xml
async function extractDocxText(file) {
  const buf  = await file.arrayBuffer();
  const raw  = new TextDecoder('utf-8', { fatal: false }).decode(new Uint8Array(buf));
  const bodyM = raw.match(/<w:body>([\s\S]*?)<\/w:body>/);
  const body  = bodyM ? bodyM[1] : raw;
  const runs  = [];
  const paraRe = /<w:p[ >]([\s\S]*?)<\/w:p>/g;
  let pm;
  while ((pm = paraRe.exec(body)) !== null) {
    const textRe = /<w:t(?:\s[^>]*)?>([^<]*)<\/w:t>/g;
    let tm, para = '';
    while ((tm = textRe.exec(pm[1])) !== null) para += tm[1];
    if (para.trim()) runs.push(para.trim());
  }
  if (runs.length > 0) return runs.join('\n');
  // Fallback: flat scan of all <w:t> runs
  const flatRe = /<w:t(?:\s[^>]*)?>([^<]*)<\/w:t>/g;
  let fm, flat = '';
  while ((fm = flatRe.exec(raw)) !== null) flat += fm[1] + ' ';
  return flat.trim();
}

// TXT / plain text
async function extractTxtText(file) {
  return new Promise((res, rej) => {
    const r = new FileReader();
    r.onload  = e => res(e.target.result || '');
    r.onerror = rej;
    r.readAsText(file, 'utf-8');
  });
}

async function handleResumeFile(file) {
  if (!file) return;
  const drop = document.getElementById('resume-drop');
  const icon = document.getElementById('resume-icon');
  const copy = document.getElementById('resume-copy');
  const skip = document.getElementById('resume-skip');

  drop.classList.remove('loaded');
  icon.innerHTML = '<span class="si lg" aria-hidden="true"><svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"><path d="M8 2.5v2"/><path d="M8 11.5v2" opacity=".4"/><path d="M13.5 8h-2" opacity=".7"/><path d="M4.5 8h-2" opacity=".3"/><path d="M11.8 4.2l-1.4 1.4" opacity=".85"/><path d="M5.6 10.4l-1.4 1.4" opacity=".25"/><path d="M11.8 11.8l-1.4-1.4" opacity=".55"/><path d="M5.6 5.6L4.2 4.2" opacity=".15"/></svg></span>';
  copy.innerHTML = '<div class="resume-copy-head">Reading resume\u2026</div>'
                 + '<div class="resume-copy-sub">Extracting text from your file</div>';
  skip.textContent = '';

  try {
    let text = '';
    const ext = file.name.split('.').pop().toLowerCase();

    if      (ext === 'pdf')                    text = await extractPDFText(file);
    else if (ext === 'docx' || ext === 'doc')  text = await extractDocxText(file);
    else                                       text = await extractTxtText(file);

    // Sanitise: strip null + control bytes, collapse whitespace
    text = text
      .replace(/\x00/g, '')
      .replace(/[\x01-\x08\x0B\x0C\x0E-\x1F\x7F]/g, ' ')
      .replace(/[ \t]{4,}/g, '   ')
      .replace(/\n{4,}/g, '\n\n')
      .trim();

    // Count real words to detect image-PDFs or binary garbage
    const realWordCount = (text.match(/[a-zA-Z]{2,}/g) || []).length;

    if (realWordCount < 25) {
      const hint = (ext === 'pdf')
        ? 'This PDF appears to be scanned (image-based) — no text layer found. Export as a text PDF, or paste your resume into a .txt file and upload that.'
        : 'Could not extract readable text. Try saving your resume as a plain .txt file and uploading that instead.';
      throw new Error(hint);
    }

    resumeText     = text.slice(0, 5000);
    resumeFileName = file.name;

    drop.classList.add('loaded');
    icon.innerHTML = '<span class="si lg" aria-hidden="true"><svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M3 8l3.5 3.5L13 5"/></svg></span>';
    copy.innerHTML = '<div class="resume-loaded-name">' + file.name + '</div>'
      + '<div class="resume-loaded-meta">~' + realWordCount
      + ' words extracted \u00b7 will be used to ground your profile</div>';
    skip.innerHTML = '<button class="resume-clear" onclick="clearResume()">Remove</button>';

  } catch (err) {
    resumeText     = '';
    resumeFileName = '';
    drop.classList.remove('loaded');
    icon.innerHTML = '<span class="si lg" aria-hidden="true"><svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M8 2L1.5 13h13z"/><path d="M8 6v4"/><circle cx="8" cy="11.5" r="0.5" fill="currentColor"/></svg></span>';
    const msg = (err.message && err.message.length < 180)
      ? err.message : 'Could not read this file.';
    copy.innerHTML = '<div class="resume-copy-head">' + msg + '</div>'
      + '<div class="resume-copy-sub">Tip: File \u2192 Save As \u2192 Plain Text (.txt) then upload that.</div>';
    skip.textContent = 'optional';
    console.error('[resume]', err);
  }
}

function clearResume() {
  resumeText     = '';
  resumeFileName = '';
  const drop = document.getElementById('resume-drop');
  const icon = document.getElementById('resume-icon');
  const copy = document.getElementById('resume-copy');
  const skip = document.getElementById('resume-skip');
  drop.classList.remove('loaded');
  icon.innerHTML = '<span class="si lg" aria-hidden="true"><svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M3 2h7l3 3v9H3z"/><path d="M10 2v3h3"/><path d="M5 7h6M5 9.5h6M5 12h4"/></svg></span>';
  copy.innerHTML = '<div class="resume-copy-head">Drop your resume here</div>'
    + '<div class="resume-copy-sub">PDF, TXT, DOC \u00b7 CareerSignal uses it to ground your profile in your real experience</div>';
  skip.textContent = 'optional';
  document.getElementById('resume-file').value = '';
}

// Drag and drop on the zone
(function initResumeDrop() {
  const drop = document.getElementById('resume-drop');
  if (!drop) return;
  drop.addEventListener('dragover', e => { e.preventDefault(); drop.classList.add('drag-active'); });
  drop.addEventListener('dragleave', () => drop.classList.remove('drag-active'));
  drop.addEventListener('drop', e => {
    e.preventDefault();
    drop.classList.remove('drag-active');
    const f = e.dataTransfer.files[0];
    if (f) handleResumeFile(f);
  });
})();

// ── MODAL: NO-RESUME NUDGE ──
function openModal() {
  const ovl = document.getElementById('modal-ovl');
  if (!ovl) return;
  ovl.classList.add('open');
  // Trap escape key
  document._modalEsc = e => { if (e.key === 'Escape') closeModal(); };
  document.addEventListener('keydown', document._modalEsc);
  // Click backdrop to dismiss
  ovl.addEventListener('click', _modalBackdropClick);
}
function _modalBackdropClick(e) {
  if (e.target === document.getElementById('modal-ovl')) closeModal();
}
function closeModal() {
  const ovl = document.getElementById('modal-ovl');
  if (!ovl) return;
  ovl.classList.remove('open');
  document.removeEventListener('keydown', document._modalEsc);
  ovl.removeEventListener('click', _modalBackdropClick);
}
function tryStart() {
  // If resume already uploaded, go straight through
  if (resumeText) {
    goTo('screen-s1');
    return;
  }
  openModal();
}
function modalUpload() {
  closeModal();
  // Scroll to resume zone and trigger file picker
  const drop = document.getElementById('resume-drop');
  if (drop) {
    drop.scrollIntoView({ behavior: 'smooth', block: 'center' });
    // Small delay so scroll settles before pulse
    setTimeout(() => {
      drop.style.transition = 'box-shadow 0.2s, border-color 0.2s';
      drop.style.boxShadow = '0 0 0 3px rgba(139,92,246,0.25)';
      drop.style.borderColor = 'rgba(139,92,246,0.55)';
      setTimeout(() => {
        drop.style.boxShadow = '';
        drop.style.borderColor = '';
        // Open file picker
        const input = document.getElementById('resume-file');
        if (input) input.click();
      }, 600);
    }, 400);
  }
}
function modalProceed() {
  closeModal();
  goTo('screen-s1');
}

// ── FORM ──
function selR(el,g){document.querySelectorAll('#'+g+' .ropt').forEach(o=>o.classList.remove('sel'));el.classList.add('sel');}
function selC(el){el.classList.toggle('sel');}
function selSc(btn,g){document.querySelectorAll('#'+g+' .scbtn').forEach(b=>b.classList.remove('sel'));btn.classList.add('sel');}
function getR(g){const s=document.querySelector('#'+g+' .ropt.sel');return s?s.querySelector('strong')?.textContent||s.querySelector('.olabel')?.textContent?.trim():null;}
function getC(g){return Array.from(document.querySelectorAll('#'+g+' .copt.sel')).map(el=>el.querySelector('.olabel')?.textContent?.trim());}
function getSc(g){const s=document.querySelector('#'+g+' .scbtn.sel');return s?s.textContent.trim():null;}
function getRank(){return Array.from(document.querySelectorAll('#q14r .rank-item')).map((r,i)=>'#'+(i+1)+': '+r.dataset.val).join(', ');}
function buildAnswers(){return{q1:getR('q1'),q2:document.getElementById('q2').value,q3:getR('q3'),q4:document.getElementById('q4').value,q5:document.getElementById('q5').value,q6:getC('q6').join('; '),q7:document.getElementById('q7').value,q8:getR('q8'),q9:getR('q9'),q10:getR('q10'),q11a:getSc('q11a'),q11b:getSc('q11b'),q12:getR('q12'),q13:document.getElementById('q13').value,q14:getRank(),q15:document.getElementById('q15').value,q16a:getR('q16a'),q16b:getR('q16b'),q16c:getR('q16c'),q16d:getR('q16d'),q17:document.getElementById('q17').value,q18:document.getElementById('q18').value,q19:getR('q19'),q20:getR('q20'),q21:document.getElementById('q21').value};}

function buildPrompt(answers) {
  const qa = Object.entries(answers).map(([k,v]) => k + ': ' + (v || '[not answered]')).join('\n');
  const hasResume = !!resumeText;

  const resumeBlock = hasResume ? `

RESUME (extract behavioral signals only — not job titles):
---
${resumeText.slice(0, 4000)}
---` : '';

  return `Extract a Career Signal Profile from the questionnaire${hasResume ? ' and resume' : ''} below.
Output ONLY a single valid JSON object. No markdown. No explanation. No text before or after the JSON.

REQUIRED JSON STRUCTURE (fill every field with real content — no placeholders):
{
  "interest_signals": [{"signal":"<behavioral pattern>","strength":<1-5>,"evidence":"<cited from answers>"}],
  "energy_profile": {"energizing_patterns":["<pattern>"],"draining_patterns":["<pattern>"]},
  "behavioral_preferences": {
    "autonomy_preference":"<low|medium|high>",
    "structure_preference":"<low|medium|high>",
    "social_intensity":"<low|medium|high>",
    "ambiguity_tolerance":"<low|medium|high>",
    "pressure_tolerance":"<low|medium|high>"
  },
  "motivation_drivers": [{"driver":"<driver>","evidence":"<cited>"}],
  "avoidance_signals": [{"signal":"<pattern>","evidence":"<cited>"}],
  "learning_velocity": "<slow|moderate|fast>",
  "tradeoff_willingness": {"willing_to_trade":["<item>"],"unwilling_to_trade":["<item>"]},
  "constraints": {"location":"<text>","work_authorization":"<text>","minimum_salary":<number or null>,"hours_per_week_available":<number or null>,"months_of_runway":<number or null>},
  "stage_context": {"current_stage":"<text>","age":"<text>"},
  "confidence": "<low|medium|high>",
  "assumptions": ["<assumption>"],
  "career_fits": {
    "primary": [
      {
        "title":"<career title>",
        "emoji":"<single emoji>",
        "match_score":<50-99>,
        "match_color":"<amber|sage|sky|lavender|rose>",
        "why_it_fits":"<2-3 sentences grounded in signals>",
        "description":"<what the role actually involves day-to-day, 2-3 sentences>",
        "specializations":["<niche>","<niche>"],
        "niches_detail":[{"name":"<niche>","what":"<1 sentence>","demand":"<low|medium|high>"}],
        "how_to_break_in":"<specific platforms, communities, certs — 2-3 sentences>",
        "entry_actions":[{"action":"<concrete step>","timeframe":"<e.g. week 1-2>"}],
        "timeline_phases":[{"phase":"<phase name>","duration":"<e.g. 3 months>","milestone":"<what you achieve>"}],
        "salary_range":"<e.g. $75k-$110k>",
        "growth_trajectory":"<where this leads in 3-5 years>"
      }
    ],
    "exploring": [ /* same structure as primary */ ]
  }
}

RULES:
- primary: exactly 2 careers. exploring: exactly 2 careers.
- entry_actions: exactly 3 items per career.
- timeline_phases: exactly 3 phases per career.
- interest_signals: 4-6 items. motivation_drivers: 3-4 items. avoidance_signals: 2-4 items.
- All string values must be actual content — never leave placeholder text.
- confidence "high" only if 5+ signals cross-validate across questionnaire${hasResume ? ' and resume' : ''}.${hasResume ? `
- Use resume to ground signals and calibrate timeline_phases to actual experience level.` : ''}
${resumeBlock}

QUESTIONNAIRE RESPONSES:
${qa}`;
}

async function animateSteps(){
  // Update step 1 label based on whether resume was uploaded
  const ls1text = document.getElementById('ls1-text');
  if (ls1text) ls1text.textContent = resumeText ? 'Parsing questionnaire + resume' : 'Parsing questionnaire responses';
  for(let i=1;i<=6;i++){await delay(500+i*100);const el=document.getElementById('ls'+i);el.classList.add('vis');await delay(400);el.classList.add('done');el.querySelector('.sbul').textContent='✓';}
}
const delay=ms=>new Promise(r=>setTimeout(r,ms));
let rawJSON='';

async function submitQ(){
  const answers=buildAnswers();
  // Show loading state on button if still visible
  const sbtn = document.getElementById('submit-btn');
  if (sbtn) { sbtn.classList.add('loading'); sbtn.setAttribute('aria-disabled','true'); }
  goTo('screen-loading');
  const anim=animateSteps();
  try{
    const res=await fetch('https://api.anthropic.com/v1/messages',{method:'POST',headers:{'Content-Type':'application/json','anthropic-dangerous-direct-browser-access':'true'},body:JSON.stringify({model:'claude-sonnet-4-6',max_tokens:8000,system:'You are a career signal extraction engine. Output ONLY valid JSON. No markdown, no preamble.',messages:[{role:'user',content:buildPrompt(answers)}]})});
    await anim;
    if(!res.ok)throw new Error('API '+res.status+': '+res.statusText);
    const data=await res.json();
    const text=data.content.map(b=>b.text||'').join('');
    // Strip markdown fences, find outermost JSON object
    const clean=(()=>{
      let s=text.replace(/```json\n?|```/g,'').replace(/^[^{]*/,'').trim();
      const start=s.indexOf('{');
      const end=s.lastIndexOf('}');
      return(start!==-1&&end!==-1)?s.slice(start,end+1):s;
    })();
    // Parse with repair: if straight parse fails, try to fix trailing truncation
    let profile;
    try {
      profile=JSON.parse(clean);
    } catch(parseErr) {
      // Truncated response — try to recover by finding last complete top-level key
      // Log the error position for debugging
      console.warn('JSON parse failed at:', parseErr.message);
      console.warn('JSON length:', clean.length, 'First 200:', clean.slice(0,200));
      // Attempt minimal repair: find last complete "}]}" or "}}" sequence
      let repaired = clean;
      // Count unclosed braces/brackets and close them
      let opens = 0, opens2 = 0;
      for(const ch of repaired) {
        if(ch==='{') opens++; else if(ch==='}') opens--;
        if(ch==='[') opens2++; else if(ch===']') opens2--;
      }
      // Close any unclosed arrays first, then objects
      repaired += ']'.repeat(Math.max(0,opens2)) + '}'.repeat(Math.max(0,opens));
      try {
        profile=JSON.parse(repaired);
        console.warn('Repaired truncated JSON successfully');
      } catch(e2) {
        throw new Error('Response JSON invalid: '+parseErr.message+'. The AI response may have been cut off. Try again.');
      }
    }
    rawJSON=clean;renderResult(profile);
    saveToHistory(profile);
    goTo('screen-result');
    const sbtn2 = document.getElementById('submit-btn');
    if (sbtn2) { sbtn2.classList.remove('loading'); sbtn2.removeAttribute('aria-disabled'); }
    // Flash "Saved ✓" only if localStorage is available
    if (lsAvailable()) {
      setTimeout(()=>{
        const hb=document.querySelector('.hist-btn');
        if(hb){const orig=hb.innerHTML;hb.innerHTML='<span style="color:var(--lime)">✓ Saved</span>';setTimeout(()=>hb.innerHTML=orig,2000);}
      },600);
    }
  }catch(err){
    const sbtn3 = document.getElementById('submit-btn');
    if (sbtn3) { sbtn3.classList.remove('loading'); sbtn3.removeAttribute('aria-disabled'); }
    await anim;rawJSON='{"error":"'+err.message+'"}';
    document.getElementById('rcontent').innerHTML='<div class="errbox"><strong>Something went wrong.</strong><br>'+err.message+'</div>';
    document.getElementById('mrow').innerHTML='';document.getElementById('jpre').textContent=err.message;
    goTo('screen-result');
  }
}

function renderResult(p){
  const cc={high:'ch',medium:'cm',low:'cl'}[p.confidence]||'cm';
  const resumeBadge = resumeText ? '<span class="sbadge" style="color:var(--lime);border-color:rgba(110,231,183,0.3);background:rgba(110,231,183,0.06)"><span class="si" aria-hidden="true"><svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M3 2h7l3 3v9H3z"/><path d="M10 2v3h3"/><path d="M5 7h6M5 9.5h6M5 12h4"/></svg></span> resume used</span>' : '';
  document.getElementById('mrow').innerHTML='<span class="cbadge '+cc+'">● '+p.confidence+' confidence</span><span class="sbadge">'+(p.stage_context?.current_stage||'unknown')+' · age '+(p.stage_context?.age||'?')+'</span>'+resumeBadge;
  let html='';const fits=p.career_fits||{};
  if(fits.primary?.length||fits.exploring?.length){
    html+='<div class="pcard"><div class="chead"><div class="clabel"><span class="si" aria-hidden="true"><svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><circle cx="8" cy="8" r="5.5"/><circle cx="8" cy="8" r="2.5"/><path d="M8 2.5v1M8 12.5v1M2.5 8h1M12.5 8h1"/></svg></span>Career Fits</div></div>';
    if(fits.primary?.length)html+='<div style="margin-bottom:1.1rem;"><div class="fit-stitle">Primary Fits</div>'+fits.primary.map(renderFitCard).join('')+'</div>';
    if(fits.exploring?.length)html+='<div><div class="fit-stitle">Worth Exploring</div>'+fits.exploring.map(renderFitCard).join('')+'</div>';
    html+='</div>';
  }
  if(p.interest_signals?.length){
    const SL=['','Weak','Moderate','Solid','Strong','Defining'];
    html+='<div class="pcard"><div class="chead"><div class="clabel"><span class="si" aria-hidden="true"><svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><circle cx="8" cy="8" r="5.5"/><path d="M8 2.5v2M8 11.5v2M2.5 8h2M11.5 8h2"/><circle cx="8" cy="8" r="1.5" fill="currentColor" stroke="none"/></svg></span>Interest Signals</div></div><div class="sigleg"><div class="ldots">'+[1,2,3,4,5].map(i=>'<div class="ld '+(i<=3?'on':'off')+'"></div>').join('')+'</div><span>Dots = signal strength 1–5. 4–5 dots = reinforced across multiple answers.</span></div>'+p.interest_signals.map(s=>'<div class="sitem"><div class="sdots">'+[1,2,3,4,5].map(i=>'<div class="sd '+(i<=s.strength?'on':'')+'"></div>').join('')+'</div><div class="sbody"><div class="sname">'+s.signal+'</div><div class="sev">'+s.evidence+'</div></div><div class="slabel">'+(SL[s.strength]||'')+'</div></div>').join('')+'</div>';
  }
  const ep=p.energy_profile||{};
  if(ep.energizing_patterns?.length||ep.draining_patterns?.length){
    html+='<div class="pcard"><div class="chead"><div class="clabel"><span class="si" aria-hidden="true"><svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M8 1.5l6 6-6 7-6-7z"/><path d="M8 1.5v13M2 7.5h12"/></svg></span>Energy Profile</div></div><div class="twocol"><div><div class="colh" style="color:var(--lime)"><span class="si" aria-hidden="true"><svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M9.5 2L5 9h5l-1.5 5 5.5-7H9z"/></svg></span> Energizes</div><div class="tags">'+(ep.energizing_patterns||[]).map(t=>'<span class="tag ts">'+t+'</span>').join('')+'</div></div><div><div class="colh" style="color:var(--orange)"><span class="si" aria-hidden="true"><svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M8 3v9"/><path d="M4.5 9L8 12.5 11.5 9"/><path d="M5 4.5h6" stroke-width="1.2" stroke-dasharray="1.5 1.5"/></svg></span> Drains</div><div class="tags">'+(ep.draining_patterns||[]).map(t=>'<span class="tag tr">'+t+'</span>').join('')+'</div></div></div></div>';
  }
  const bp=p.behavioral_preferences||{};
  if(Object.keys(bp).length){
    html+='<div class="pcard"><div class="chead"><div class="clabel"><span class="si" aria-hidden="true"><svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="2" width="5" height="5" rx="1"/><rect x="9" y="2" width="5" height="5" rx="1"/><rect x="2" y="9" width="5" height="5" rx="1"/><path d="M9 11.5h5M9 13.5h3"/></svg></span>Behavioral Preferences</div></div><div class="bgrid">'+Object.entries(bp).map(([k,v])=>'<div class="bitem"><div class="bk">'+k.replace(/_/g,' ')+'</div><div class="bv">'+v+'</div><div class="bbar" data-v="'+v+'"></div></div>').join('')+'</div>'+(p.learning_velocity?'<div style="margin-top:0.8rem;display:flex;align-items:center;gap:0.55rem;"><span style="font-size:0.7rem;color:var(--text-3);text-transform:uppercase;letter-spacing:0.06em;font-weight:600;">Learning velocity</span><span class="tag tl">'+p.learning_velocity+'</span></div>':'')+'</div>';
  }
  if(p.motivation_drivers?.length)html+='<div class="pcard"><div class="chead"><div class="clabel"><span class="si" aria-hidden="true"><svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M10.5 2a3.5 3.5 0 0 1 .5 5.5L5.5 13a1.5 1.5 0 0 1-2-2L9 5.5A3.5 3.5 0 0 1 10.5 2z"/><circle cx="10.5" cy="4" r="1" fill="currentColor" stroke="none"/></svg></span>Motivation Drivers</div></div>'+p.motivation_drivers.map(m=>'<div class="mitem"><div class="mdrv">'+m.driver+'</div><div class="mev">'+m.evidence+'</div></div>').join('')+'</div>';
  if(p.avoidance_signals?.length)html+='<div class="pcard"><div class="chead"><div class="clabel"><span class="si" aria-hidden="true"><svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M2 12h4V8h4V4h4"/></svg></span>Avoidance Signals</div></div>'+p.avoidance_signals.map(a=>'<div class="aitem"><div class="asig">'+a.signal+'</div><div class="aev">'+a.evidence+'</div></div>').join('')+'</div>';
  const tw=p.tradeoff_willingness||{};
  if(tw.willing_to_trade?.length||tw.unwilling_to_trade?.length)html+='<div class="pcard"><div class="chead"><div class="clabel"><span class="si" aria-hidden="true"><svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"><path d="M1.5 8h13"/><path d="M4.5 5.5v5M8 5.5v5M11.5 5.5v5"/></svg></span>Tradeoff Willingness</div></div><div class="twocol"><div><div class="colh" style="color:var(--text-3)">Willing to give up</div><div class="tags">'+(tw.willing_to_trade||[]).map(t=>'<span class="tag td">'+t+'</span>').join('')+'</div></div><div><div class="colh" style="color:var(--orange)">Won\'t sacrifice</div><div class="tags">'+(tw.unwilling_to_trade||[]).map(t=>'<span class="tag tr">'+t+'</span>').join('')+'</div></div></div></div>';
  const c=p.constraints||{};
  const cr=[['Location',c.location],['Work authorization',c.work_authorization],['Minimum salary',c.minimum_salary!=null?'$'+Number(c.minimum_salary).toLocaleString():null],['Hours/week',c.hours_per_week_available],['Runway (months)',c.months_of_runway]].filter(([,v])=>v!=null&&v!=='null');
  if(cr.length)html+='<div class="pcard"><div class="chead"><div class="clabel"><span class="si" aria-hidden="true"><svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M3.5 2h9v12l-4.5-3-4.5 3z"/></svg></span>Hard Constraints</div></div>'+cr.map(([k,v])=>'<div class="crow"><span class="ck">'+k+'</span><span class="cv">'+v+'</span></div>').join('')+'</div>';
  if(p.assumptions?.length)html+='<div class="pcard"><div class="chead"><div class="clabel"><span class="si" aria-hidden="true"><svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"><circle cx="8" cy="3" r="1.75"/><circle cx="2.5" cy="12" r="1.75"/><circle cx="13.5" cy="12" r="1.75"/><path d="M7 4.5L3.5 10.5M9 4.5l4 6M4.5 12h7"/></svg></span>Assumptions Made</div></div><ul class="alist">'+p.assumptions.map(a=>'<li>'+a+'</li>').join('')+'</ul></div>';
  document.getElementById('rcontent').innerHTML=html;
  try{document.getElementById('jpre').innerHTML=syntaxHL(JSON.parse(rawJSON));}catch{document.getElementById('jpre').textContent=rawJSON;}
}

let fitN=0;
function renderFitCard(f){
  const id='fc'+(fitN++);
  const cmap={amber:'var(--pink)',sage:'var(--lime)',sky:'var(--cyan)',lavender:'#a78bfa',rose:'var(--orange)'};
  const col=cmap[f.match_color]||'var(--pink)';
  const pct=Math.min(100,Math.max(0,f.match_score||70));
  const tlHTML=(f.timeline_phases||[]).map((ph,i)=>'<div class="tlph"><div class="tldot">'+(i+1)+'</div><div class="tllab">'+ph.phase+'</div><div class="tltime">'+ph.duration+'</div></div>').join('<div style="width:28px;display:flex;align-items:flex-start;justify-content:center;padding-top:10px;color:var(--border2);font-size:0.7rem;">→</div>');
  const eaHTML=(f.entry_actions||[]).map(a=>'<div class="eaitem"><span class="eatf">'+a.timeframe+'</span><span class="eaact">'+a.action+'</span></div>').join('');
  const nichesHTML=(f.niches_detail||[]).map(n=>{const dc=n.demand==='high'?'var(--lime)':n.demand==='low'?'var(--orange)':'var(--pink)';return'<div class="niche-item"><div class="niche-head"><span class="niche-name">'+n.name+'</span><span class="niche-dem" style="color:'+dc+'">'+n.demand+' demand</span></div><div class="niche-what">'+n.what+'</div></div>';}).join('');
  const specsHTML=(f.specializations||[]).map(s=>'<span class="spchip">'+s+'</span>').join('');
  return'<div class="fitcard" id="'+id+'"><button class="fctrig" onclick="toggleFit(\''+id+'\')"><div class="ficon"><span class="si" aria-hidden="true"><svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><rect x="1.5" y="5.5" width="13" height="8.5" rx="1.5"/><path d="M5.5 5.5V4A1.5 1.5 0 0 1 7 2.5h2A1.5 1.5 0 0 1 10.5 4v1.5"/><line x1="1.5" y1="9.5" x2="14.5" y2="9.5"/></svg></span></div><div class="ftwrap"><div class="ftitle">'+f.title+'</div><div class="fsub">'+(f.salary_range||'')+'</div></div><div class="fmatch"><span class="fpct" style="color:'+col+'">'+f.match_score+'%</span><div class="fbarw"><div class="fbar" style="width:'+pct+'%;background:'+col+'"></div></div></div><div class="fchev"><svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="6 9 12 15 18 9"/></svg></div></button><div class="fcbody"><div class="fcinner"><p class="fdesc">'+(f.why_it_fits||'')+'</p>'+mkSub(id+'-desc','<span class="si" aria-hidden="true"><svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="2.5" width="10" height="12" rx="1.5"/><path d="M6 2.5V1.5h4v1"/><path d="M5.5 7h5M5.5 9.5h5M5.5 12h3"/></svg></span>','What this career actually involves','<div class="subtext">'+(f.description||'')+'</div>')+mkSub(id+'-spec','<span class="si" aria-hidden="true"><svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"><circle cx="8" cy="8" r="6"/><circle cx="8" cy="8" r="3.5"/><circle cx="8" cy="8" r="1" fill="currentColor" stroke="none"/></svg></span>','Specializations & niches','<div class="specgrid">'+specsHTML+'</div>'+(nichesHTML?'<div style="margin-top:0.65rem">'+nichesHTML+'</div>':''))+mkSub(id+'-break','<span class="si" aria-hidden="true"><svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M3 14.5V2a1 1 0 0 1 1-1h8a1 1 0 0 1 1 1v12.5"/><path d="M1.5 14.5h13"/><circle cx="11" cy="8" r="0.75" fill="currentColor" stroke="none"/></svg></span>','How to break in','<div class="subtext">'+(f.how_to_break_in||'')+'</div>'+(eaHTML?'<div style="margin-top:0.7rem">'+eaHTML+'</div>':''))+mkSub(id+'-tl','<span class="si" aria-hidden="true"><svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><rect x="1.5" y="3" width="13" height="11" rx="1.5"/><path d="M1.5 6.5h13"/><path d="M5 1.5v3M11 1.5v3"/><path d="M4.5 9.5h1M7.5 9.5h1M10.5 9.5h1M4.5 12h1M7.5 12h1"/></svg></span>','Timeline to get established','<div class="tlrow">'+tlHTML+'</div>'+(f.growth_trajectory?'<div class="subtext" style="margin-top:0.65rem">'+f.growth_trajectory+'</div>':''))+'</div></div></div>';
}
function mkSub(id,icon,label,content){return'<div class="subcol" id="'+id+'"><button class="subtrig" onclick="toggleSub(\''+id+'\')"><div class="stico">'+icon+'</div><div class="stlab">'+label+'</div><div class="stchev">▾</div></button><div class="subbody"><div class="subinner">'+content+'</div></div></div>';}
function toggleFit(id){document.getElementById(id).classList.toggle('open');}
function toggleSub(id){document.getElementById(id).classList.toggle('open');}

function syntaxHL(json){const s=JSON.stringify(json,null,2);return s.replace(/("(\\u[a-zA-Z0-9]{4}|\\[^u]|[^\\"])*"(\s*:)?|\b(true|false|null)\b|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?)/g,m=>{if(/^"/.test(m))return/:$/.test(m)?'<span class="jk">'+m+'</span>':'<span class="js">'+m+'</span>';if(/true|false/.test(m)||m==='null')return'<span class="jb">'+m+'</span>';return'<span class="jn">'+m+'</span>';});}
function copyJSON(){navigator.clipboard.writeText(rawJSON||'{}').then(()=>{const btn=document.querySelector('.copybtn');btn.textContent='Copied!';setTimeout(()=>btn.textContent='Copy',2000);});}

const HK='cs_history_v3';

// Check if localStorage is available at all
function lsAvailable() {
  try { localStorage.setItem('__test__','1'); localStorage.removeItem('__test__'); return true; }
  catch(e) { return false; }
}

function loadHist() {
  if (!lsAvailable()) return [];
  try { return JSON.parse(localStorage.getItem(HK)) || []; } catch { return []; }
}

function saveHist(h) {
  if (!lsAvailable()) return false;
  // Trim to 8 entries max to keep storage footprint small
  const trimmed = h.slice(0, 8);
  let attempt = 0;
  let toSave = trimmed;
  while (attempt < 4) {
    try {
      localStorage.setItem(HK, JSON.stringify(toSave));
      return true;
    } catch(e) {
      if (toSave.length > 1) {
        toSave = toSave.slice(0, Math.ceil(toSave.length / 2));
        attempt++;
      } else {
        // Single entry still too big — store without raw JSON
        try {
          const minimal = [{...toSave[0], raw: null}];
          localStorage.setItem(HK, JSON.stringify(minimal));
          return true;
        } catch { return false; }
      }
    }
  }
  return false;
}
function saveToHistory(profile) {
  if (!lsAvailable()) {
    // Show a brief non-blocking note in the history button area
    const hb = document.querySelector('.hist-btn');
    if (hb) { const orig = hb.innerHTML; hb.innerHTML = '<span style="color:var(--orange);font-size:0.75rem">storage unavailable</span>'; setTimeout(() => hb.innerHTML = orig, 3000); }
    return;
  }
  const h = loadHist();
  h.unshift({
    id: Date.now(),
    date: new Date().toLocaleString(),
    stage: profile.stage_context?.current_stage || 'unknown',
    confidence: profile.confidence || 'low',
    fits: (profile.career_fits?.primary || []).map(f => f.title).join(', '),
    signals: (profile.interest_signals || []).slice(0, 3).map(s => s.signal).join(', '),
    raw: rawJSON
  });
  saveHist(h);
  updateHistCount();
}
function updateHistCount(){const n=loadHist().length;const el=document.getElementById('hcnt');el.style.display=n?'inline-flex':'none';el.textContent=n;}
function renderDrawer(){const h=loadHist();const body=document.getElementById('dbody');if(!h.length){body.innerHTML='<div class="dempty"><div class="dempty-ico"><span class="si" aria-hidden="true"><svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M1.5 4.5A1.5 1.5 0 0 1 3 3h3l1.5 2H13A1.5 1.5 0 0 1 14.5 6.5v6A1.5 1.5 0 0 1 13 14H3A1.5 1.5 0 0 1 1.5 12.5z"/></svg></span></div>No saved profiles yet.<br>Complete the questionnaire to save your first career signal profile.</div>';return;}body.innerHTML=h.map(e=>'<div class="hitem" onclick="loadEntry('+e.id+')"><button class="hdel" onclick="event.stopPropagation();delEntry('+e.id+')"><span class="si" aria-hidden="true"><svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"><path d="M4 4l8 8M12 4l-8 8"/></svg></span></button><div class="hidate">'+e.date+'</div><div class="histage">'+e.stage+' · '+e.confidence+' confidence</div><div class="hiprev">'+(e.fits||e.signals||'No signals extracted')+'</div></div>').join('');}
function loadEntry(id) {
  const e = loadHist().find(x => x.id === id);
  if (!e) return;
  if (!e.raw) {
    alert('This profile was saved without full data and cannot be loaded.');
    return;
  }
  rawJSON = e.raw;
  fitN = 0;
  try {
    const profile = e.profile || JSON.parse(rawJSON);
    renderResult(profile);
    closeDrawer();
    goTo('screen-result');
  } catch(err) {
    console.warn('Failed to load history entry:', err.message);
    alert('Could not load this profile — the data may be corrupted.');
  }
}
function delEntry(id){saveHist(loadHist().filter(e=>e.id!==id));updateHistCount();renderDrawer();}
function openDrawer(){renderDrawer();document.getElementById('drawer').classList.add('open');document.getElementById('dovl').classList.add('open');}
function closeDrawer(){document.getElementById('drawer').classList.remove('open');document.getElementById('dovl').classList.remove('open');}
function startOver(){document.querySelectorAll('.ropt.sel,.copt.sel').forEach(el=>el.classList.remove('sel'));document.querySelectorAll('.scbtn.sel').forEach(el=>el.classList.remove('sel'));document.querySelectorAll('textarea,input[type="text"],input[type="number"]').forEach(el=>el.value='');document.querySelectorAll('select').forEach(el=>el.selectedIndex=0);for(let i=1;i<=6;i++){const el=document.getElementById('ls'+i);if(el){el.classList.remove('vis','done');el.querySelector('.sbul').textContent=i;}}rawJSON='';fitN=0;document.getElementById('rcontent').innerHTML='';document.getElementById('mrow').innerHTML='';document.getElementById('jpre').textContent='';clearResume();goTo('screen-intro');}


// ── Q14 DRAG TO RANK ──
(function initDragRank() {
  const list = document.getElementById('q14r');
  if (!list) return;
  let dragging = null, startY = 0, startTop = 0, clone = null;

  function getItems() { return Array.from(list.querySelectorAll('.rank-item')); }
  function updatePositions() { getItems().forEach((el, i) => { el.querySelector('.rank-pos').textContent = i + 1; }); }

  function onMove(e) {
    if (!dragging) return;
    e.preventDefault();
    const clientY = e.touches ? e.touches[0].clientY : e.clientY;
    clone.style.top = (startTop + clientY - startY) + 'px';
    const cloneCenter = clone.getBoundingClientRect().top + clone.offsetHeight / 2;
    getItems().filter(el => el !== dragging).forEach(el => {
      const r = el.getBoundingClientRect();
      el.classList.toggle('drag-over', Math.abs(cloneCenter - (r.top + r.height / 2)) < r.height * 0.6);
    });
  }

  function onUp(e) {
    if (!dragging) return;
    const cloneCenter = clone.getBoundingClientRect().top + clone.offsetHeight / 2;
    const items = getItems().filter(el => el !== dragging);
    let nearest = null, nearestDist = Infinity, insertBefore = true;
    items.forEach(el => {
      el.classList.remove('drag-over');
      const r = el.getBoundingClientRect();
      const center = r.top + r.height / 2;
      const dist = Math.abs(cloneCenter - center);
      if (dist < nearestDist) { nearestDist = dist; nearest = el; insertBefore = cloneCenter < center; }
    });
    if (nearest) { if (insertBefore) list.insertBefore(dragging, nearest); else nearest.insertAdjacentElement('afterend', dragging); }
    dragging.classList.remove('dragging'); dragging.style.opacity = '';
    clone.remove(); dragging = null; clone = null;
    updatePositions();
    document.removeEventListener('mousemove', onMove);
    document.removeEventListener('mouseup', onUp);
    document.removeEventListener('touchmove', onMove);
    document.removeEventListener('touchend', onUp);
  }

  function startDrag(e) {
    const item = e.target.closest('.rank-item');
    if (!item) return;
    e.preventDefault();
    const clientY = e.touches ? e.touches[0].clientY : e.clientY;
    dragging = item; dragging.classList.add('dragging');
    startY = clientY;
    const rect = item.getBoundingClientRect(); startTop = rect.top;
    clone = item.cloneNode(true);
    clone.style.cssText = `position:fixed;left:${rect.left}px;top:${rect.top}px;width:${rect.width}px;z-index:9000;opacity:0.95;pointer-events:none;box-shadow:0 4px 20px rgba(109,77,224,0.25);border:1px solid rgba(139,92,246,0.4);background:#1c1c2a;border-radius:12px;transition:none;`;
    document.body.appendChild(clone);
    document.addEventListener('mousemove', onMove);
    document.addEventListener('mouseup', onUp);
    document.addEventListener('touchmove', onMove, { passive: false });
    document.addEventListener('touchend', onUp);
  }

  list.addEventListener('mousedown', startDrag);
  list.addEventListener('touchstart', startDrag, { passive: false });
  updatePositions();
})();

updateHistCount();
// Debug mode: show raw JSON section if ?debug=1
(function checkDebugMode() {
  if (new URLSearchParams(window.location.search).get('debug') === '1') {
    document.querySelectorAll('.debug-section').forEach(el => el.style.removeProperty('display'));
  }
})();</script>
</body>
</html>
